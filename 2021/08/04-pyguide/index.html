<!DOCTYPE html>




<html class="theme-next gemini" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="KWEKu7-400JMONtPKXdBIPQ4ICpSLiomHWycMvJiiUw">








  <meta name="baidu-site-verification" content="wR0oqfu7r3">







  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next_bk.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next_bk.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next_bk.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Python,Google,">





  <link rel="alternate" href="/atom.xml" title="Liao's Blog" type="application/atom+xml">






<meta name="description" content="本文翻译自Google Python Style Guide，请勿用于商业用途。">
<meta name="keywords" content="Python,Google">
<meta property="og:type" content="article">
<meta property="og:title" content="【译】谷歌Python代码规范（翻译中）">
<meta property="og:url" content="https://liaocy.net/2021/08/04-pyguide/index.html">
<meta property="og:site_name" content="Liao&#39;s Blog">
<meta property="og:description" content="本文翻译自Google Python Style Guide，请勿用于商业用途。">
<meta property="og:locale" content="CN-ZH">
<meta property="og:updated_time" content="2021-08-04T06:43:36.346Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【译】谷歌Python代码规范（翻译中）">
<meta name="twitter:description" content="本文翻译自Google Python Style Guide，请勿用于商业用途。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://liaocy.net/2021/08/04-pyguide/">





  <title>【译】谷歌Python代码规范（翻译中） | Liao's Blog</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0974e06186820775f8d51e33bc87d4dd";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="CN-ZH">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Liao's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Development & Research</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="https://www.linkedin.com/in/liaocy/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaocy.net/2021/08/04-pyguide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chenyi Liao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">【译】谷歌Python代码规范（翻译中）</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-08-04T14:30:00+09:00">
                2021-08-04
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/开发-Development/" itemprop="url" rel="index">
                    <span itemprop="name">开发 Development</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/开发-Development/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2021/08/04-pyguide/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/08/04-pyguide/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>本文翻译自<a href="https://google.github.io/styleguide/pyguide.html" target="_blank" rel="noopener">Google Python Style Guide</a>，请勿用于商业用途。</p>
<a id="more"></a>
<!--
AUTHORS:
Prefer only GitHub-flavored Markdown in external text.
See README.md for details.
-->
<h1 id="谷歌Python代码规范"><a href="#谷歌Python代码规范" class="headerlink" title="谷歌Python代码规范"></a>谷歌Python代码规范</h1><!-- markdown="1" is required for GitHub Pages to render the TOC properly. -->
<p><a id="s1-background"></a><br><a id="1-background"></a></p>
<p><a id="background"></a></p>
<h2 id="1-背景"><a href="#1-背景" class="headerlink" title="1 背景"></a>1 背景</h2><p>Python是谷歌使用的一种主要的动态语言，本规范通过列出正误例子，来帮助你以正确的格式编写Python代码。<br>我们为Vim创建了一个<a href="google_python_style.vim">配置文件</a>。<br>对于Emacs而言，用它本来的默认设置就可以了。</p>
<p>也有很多团队使用<a href="https://github.com/google/yapf/" target="_blank" rel="noopener">yapf</a>自动格式化代码来避免格式争议。</p>
<p><a id="s2-python-language-rules"></a><br><a id="2-python-language-rules"></a></p>
<p><a id="python-language-rules"></a></p>
<h2 id="2-Python语言规则"><a href="#2-Python语言规则" class="headerlink" title="2 Python语言规则"></a>2 Python语言规则</h2><p><a id="s2.1-lint"></a><br><a id="21-lint"></a></p>
<p><a id="lint"></a></p>
<h3 id="2-1-Lint"><a href="#2-1-Lint" class="headerlink" title="2.1 Lint"></a>2.1 Lint</h3><p>使用<a href="https://google.github.io/styleguide/pylintrc" target="_blank" rel="noopener">pylintrc</a>，在你的代码上运行<code>pylint</code>。</p>
<p><a id="s2.1.1-definition"></a><br><a id="211-definition"></a></p>
<p><a id="lint-definition"></a></p>
<h4 id="2-1-1-定义"><a href="#2-1-1-定义" class="headerlink" title="2.1.1 定义"></a>2.1.1 定义</h4><p><code>pylint</code>是一个用来发现Python源代码中的Bug和格式问题的工具。<br>它可以找到那些典型的非动态语言，例如C和C++，的编译器才能捕捉到的问题。<br>毕竟由于Python是一种动态语言，（它给出）的一些警告可能是错误的。<br>但是这些误报并不经常出现。</p>
<p><a id="s2.1.2-pros"></a><br><a id="212-pros"></a></p>
<p><a id="lint-pros"></a></p>
<h4 id="2-1-2-优点"><a href="#2-1-2-优点" class="headerlink" title="2.1.2 优点"></a>2.1.2 优点</h4><p>捕获容易出现的错误，如拼写错误、赋值前使用变量等。</p>
<p><a id="s2.1.3-cons"></a><br><a id="213-cons"></a></p>
<p><a id="lint-cons"></a></p>
<h4 id="2-1-3-缺点"><a href="#2-1-3-缺点" class="headerlink" title="2.1.3 缺点"></a>2.1.3 缺点</h4><p><code>pylint</code>并不完美。为了利用它，有时我们需要迎合它来写代码，抑制其警告或修复它。</p>
<p><a id="s2.1.4-decision"></a><br><a id="214-decision"></a></p>
<p><a id="lint-decision"></a></p>
<h4 id="2-1-4-结论"><a href="#2-1-4-结论" class="headerlink" title="2.1.4 结论"></a>2.1.4 结论</h4><p>请确保你在你的代码上执行了<code>pylint</code>。</p>
<p>如果发现误报，则取消该警告，以免遗漏其他警告。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dict = <span class="string">'something awful'</span>  <span class="comment"># Bad Idea... pylint: disable=redefined-builtin</span></span><br></pre></td></tr></table></figure>
<p><code>pylint</code>的每个警告都由符号名称标识（<code>empty-docstring</code>）。<br>谷歌特定的警告则由<code>g-</code>开头。</p>
<p>如果你无法消除这些警告，请添加一个注释说明。</p>
<p>以这种抑制警告的好处是我们可以轻松搜索抑制掉的警告并重新审视它们。</p>
<p>你可以通过以下代码列出<code>pylint</code>的警告</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pylint --list-msgs</span><br></pre></td></tr></table></figure>
<p>如果你想得到特定警告内容的更多信息，请使用：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pylint --help-msg=C6409</span><br></pre></td></tr></table></figure></p>
<p>我们更偏爱<code>pylint: disable</code>而不是已经过时的<code>pylint: disable-msg</code>。</p>
<p>你可以在函数的开始处删除多余的变量（用del释放掉多余的变量）来抑制未使用参数的警告。<br>请留下一个说明告诉我们你为什么删掉了它。<br>仅仅注释“没用”就足够了。</p>
<p>例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">viking_cafe_order</span><span class="params">(spam: str, beans: str, eggs: Optional[str] = None)</span> -&gt; str:</span></span><br><span class="line">    <span class="keyword">del</span> beans, eggs  <span class="comment"># 没用 by vikings.</span></span><br><span class="line">    <span class="keyword">return</span> spam + spam + spam</span><br></pre></td></tr></table></figure>
<p>其他还有一些抑制警告的常见的形式。<br>包括使用’<code>_</code>‘作为未用参数的标识符，或者给未使用参数附上’<code>unused_</code>‘的前缀，或者把他们赋值到’<code>_</code>‘。<br>这些形式可以用，但是不鼓励。<br>他们通过名称传递参数，但并不强制要求参数必须实际使用。</p>
<p><a id="s2.2-imports"></a><br><a id="22-imports"></a></p>
<p><a id="imports"></a></p>
<h3 id="2-2-导入-Import"><a href="#2-2-导入-Import" class="headerlink" title="2.2 导入 Import"></a>2.2 导入 Import</h3><p>只在包（packages）和模块（modules）上使用<code>import</code>，而不要把<code>import</code>用于类和函数。<br>但从<a href="#typing-imports">typing module</a>,<br><a href="https://github.com/python/typing/tree/master/typing_extensions" target="_blank" rel="noopener">typing_extensions module</a>，<br>和<a href="https://six.readthedocs.io/#module-six.moves" target="_blank" rel="noopener">six.moves module</a>导入是不受次规则限制。</p>
<p><a id="s2.2.1-definition"></a><br><a id="221-definition"></a></p>
<p><a id="imports-definition"></a></p>
<h4 id="2-2-1-定义"><a href="#2-2-1-定义" class="headerlink" title="2.2.1 定义"></a>2.2.1 定义</h4><p>提供一种从一个模块到另一个模块的可重用的共享代码机制。</p>
<p><a id="s2.2.2-pros"></a><br><a id="222-pros"></a></p>
<p><a id="imports-pros"></a></p>
<h4 id="2-2-2-优点"><a href="#2-2-2-优点" class="headerlink" title="2.2.2 优点"></a>2.2.2 优点</h4><p>命名空间管理的规则会变得很简单。<br>每一个标识符的来源都可以按照固定的规则表示。<br>例如<code>x.Obj</code>则说明<code>Obj</code>在模块<code>x</code>中定义。</p>
<p><a id="s2.2.3-cons"></a><br><a id="223-cons"></a></p>
<p><a id="imports-cons"></a></p>
<h4 id="2-2-3-缺点"><a href="#2-2-3-缺点" class="headerlink" title="2.2.3 缺点"></a>2.2.3 缺点</h4><p>即使是模块名也是可能会冲突的。<br>而且一些模块名可能很长。</p>
<p><a id="s2.2.4-decision"></a><br><a id="224-decision"></a></p>
<p><a id="imports-decision"></a></p>
<h4 id="2-2-4-结论"><a href="#2-2-4-结论" class="headerlink" title="2.2.4 结论"></a>2.2.4 结论</h4><ul>
<li>使用<code>import x</code>来导入包或者模块</li>
<li>使用<code>from x import y</code>，其中x是包名，<code>y</code>是没有前缀的模块名</li>
<li>使用<code>from x import y as z</code>，如果两个模块都被命名为<code>y</code>且需要同时导入；或者<code>y</code>是一个超长的名字。</li>
<li>使用<code>import y as z</code>，仅当<code>z</code>是一个标准缩写时。（例如<code>numpy</code>的标准缩写<code>np</code>）</li>
</ul>
<p>比如说<code>sound.effects.echo</code>可能按照以下的方式导入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sound.effects <span class="keyword">import</span> echo</span><br><span class="line">...</span><br><span class="line">echo.EchoFilter(input, output, delay=<span class="number">0.7</span>, atten=<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<p>不要利用相对名称进行导入。<br>即使这个模块在相同的包里。<br>请使用完全包名称。<br>这样可以避免无意中两次导入了相同的包</p>
<p><a id="s2.3-packages"></a><br><a id="23-packages"></a></p>
<p><a id="packages"></a></p>
<h3 id="2-3-包-Packages"><a href="#2-3-包-Packages" class="headerlink" title="2.3 包 Packages"></a>2.3 包 Packages</h3><p>导入任何一个模块时，都使用该模块完全路径名称。</p>
<p><a id="s2.3.1-pros"></a><br><a id="231-pros"></a></p>
<p><a id="packages-pros"></a></p>
<h4 id="2-3-1-Pros"><a href="#2-3-1-Pros" class="headerlink" title="2.3.1 Pros"></a>2.3.1 Pros</h4><p>Avoids conflicts in module names or incorrect imports due to the module search<br>path not being what the author expected. Makes it easier to find modules.</p>
<p><a id="s2.3.2-cons"></a><br><a id="232-cons"></a></p>
<p><a id="packages-cons"></a></p>
<h4 id="2-3-2-Cons"><a href="#2-3-2-Cons" class="headerlink" title="2.3.2 Cons"></a>2.3.2 Cons</h4><p>Makes it harder to deploy code because you have to replicate the package<br>hierarchy. Not really a problem with modern deployment mechanisms.</p>
<p><a id="s2.3.3-decision"></a><br><a id="233-decision"></a></p>
<p><a id="packages-decision"></a></p>
<h4 id="2-3-3-Decision"><a href="#2-3-3-Decision" class="headerlink" title="2.3.3 Decision"></a>2.3.3 Decision</h4><p>All new code should import each module by its full package name.</p>
<p>Imports should be as follows:</p>
<p>Yes:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reference absl.flags in code with the complete name (verbose).</span></span><br><span class="line"><span class="keyword">import</span> absl.flags</span><br><span class="line"><span class="keyword">from</span> doctor.who <span class="keyword">import</span> jodie</span><br><span class="line"></span><br><span class="line">FLAGS = absl.flags.FLAGS</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reference flags in code with just the module name (common).</span></span><br><span class="line"><span class="keyword">from</span> absl <span class="keyword">import</span> flags</span><br><span class="line"><span class="keyword">from</span> doctor.who <span class="keyword">import</span> jodie</span><br><span class="line"></span><br><span class="line">FLAGS = flags.FLAGS</span><br></pre></td></tr></table></figure>
<p>No: <em>(assume this file lives in <code>doctor/who/</code> where <code>jodie.py</code> also exists)</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Unclear what module the author wanted and what will be imported.  The actual</span></span><br><span class="line"><span class="comment"># import behavior depends on external factors controlling sys.path.</span></span><br><span class="line"><span class="comment"># Which possible jodie module did the author intend to import?</span></span><br><span class="line"><span class="keyword">import</span> jodie</span><br></pre></td></tr></table></figure>
<p>The directory the main binary is located in should not be assumed to be in<br><code>sys.path</code> despite that happening in some environments. This being the case,<br>code should assume that <code>import jodie</code> refers to a third party or top level<br>package named <code>jodie</code>, not a local <code>jodie.py</code>.</p>
<p><a id="s2.4-exceptions"></a><br><a id="24-exceptions"></a></p>
<p><a id="exceptions"></a></p>
<h3 id="2-4-Exceptions"><a href="#2-4-Exceptions" class="headerlink" title="2.4 Exceptions"></a>2.4 Exceptions</h3><p>Exceptions are allowed but must be used carefully.</p>
<p><a id="s2.4.1-definition"></a><br><a id="241-definition"></a></p>
<p><a id="exceptions-definition"></a></p>
<h4 id="2-4-1-Definition"><a href="#2-4-1-Definition" class="headerlink" title="2.4.1 Definition"></a>2.4.1 Definition</h4><p>Exceptions are a means of breaking out of normal control flow to handle errors<br>or other exceptional conditions.</p>
<p><a id="s2.4.2-pros"></a><br><a id="242-pros"></a></p>
<p><a id="exceptions-pros"></a></p>
<h4 id="2-4-2-Pros"><a href="#2-4-2-Pros" class="headerlink" title="2.4.2 Pros"></a>2.4.2 Pros</h4><p>The control flow of normal operation code is not cluttered by error-handling<br>code. It also allows the control flow to skip multiple frames when a certain<br>condition occurs, e.g., returning from N nested functions in one step instead of<br>having to plumb error codes through.</p>
<p><a id="s2.4.3-cons"></a><br><a id="243-cons"></a></p>
<p><a id="exceptions-cons"></a></p>
<h4 id="2-4-3-Cons"><a href="#2-4-3-Cons" class="headerlink" title="2.4.3 Cons"></a>2.4.3 Cons</h4><p>May cause the control flow to be confusing. Easy to miss error cases when making<br>library calls.</p>
<p><a id="s2.4.4-decision"></a><br><a id="244-decision"></a></p>
<p><a id="exceptions-decision"></a></p>
<h4 id="2-4-4-Decision"><a href="#2-4-4-Decision" class="headerlink" title="2.4.4 Decision"></a>2.4.4 Decision</h4><p>Exceptions must follow certain conditions:</p>
<ul>
<li>Make use of built-in exception classes when it makes sense. For example,<br>raise a <code>ValueError</code> to indicate a programming mistake like a violated<br>precondition (such as if you were passed a negative number but required a<br>positive one). Do not use <code>assert</code> statements for validating argument values<br>of a public API. <code>assert</code> is used to ensure internal correctness, not to<br>enforce correct usage nor to indicate that some unexpected event occurred.<br>If an exception is desired in the latter cases, use a raise statement. For<br>example:</li>
</ul>
<pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">connect_to_next_port</span><span class="params">(self, minimum: int)</span> -&gt; int:</span></span><br><span class="line">    <span class="string">"""Connects to the next available port.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">      minimum: A port value greater or equal to 1024.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">      The new minimum port.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Raises:</span></span><br><span class="line"><span class="string">      ConnectionError: If no available port is found.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> minimum &lt; <span class="number">1024</span>:</span><br><span class="line">      <span class="comment"># Note that this raising of ValueError is not mentioned in the doc</span></span><br><span class="line">      <span class="comment"># string's "Raises:" section because it is not appropriate to</span></span><br><span class="line">      <span class="comment"># guarantee this specific behavioral reaction to API misuse.</span></span><br><span class="line">      <span class="keyword">raise</span> ValueError(<span class="string">f'Min. port must be at least 1024, not <span class="subst">&#123;minimum&#125;</span>.'</span>)</span><br><span class="line">    port = self._find_next_open_port(minimum)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> port:</span><br><span class="line">      <span class="keyword">raise</span> ConnectionError(</span><br><span class="line">          <span class="string">f'Could not connect to service on port <span class="subst">&#123;minimum&#125;</span> or higher.'</span>)</span><br><span class="line">    <span class="keyword">assert</span> port &gt;= minimum, (</span><br><span class="line">        <span class="string">f'Unexpected port <span class="subst">&#123;port&#125;</span> when minimum was <span class="subst">&#123;minimum&#125;</span>.'</span>)</span><br><span class="line">    <span class="keyword">return</span> port</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">connect_to_next_port</span><span class="params">(self, minimum: int)</span> -&gt; int:</span></span><br><span class="line">    <span class="string">"""Connects to the next available port.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">      minimum: A port value greater or equal to 1024.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">      The new minimum port.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">assert</span> minimum &gt;= <span class="number">1024</span>, <span class="string">'Minimum port must be at least 1024.'</span></span><br><span class="line">    port = self._find_next_open_port(minimum)</span><br><span class="line">    <span class="keyword">assert</span> port <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span></span><br><span class="line">    <span class="keyword">return</span> port</span><br></pre></td></tr></table></figure>
</code></pre><ul>
<li><p>Libraries or packages may define their own exceptions. When doing so they<br>must inherit from an existing exception class. Exception names should end in<br><code>Error</code> and should not introduce stutter (<code>foo.FooError</code>).</p>
</li>
<li><p>Never use catch-all <code>except:</code> statements, or catch <code>Exception</code> or<br><code>StandardError</code>, unless you are</p>
<ul>
<li>re-raising the exception, or</li>
<li>creating an isolation point in the program where exceptions are not<br>propagated but are recorded and suppressed instead, such as protecting a<br>thread from crashing by guarding its outermost block.</li>
</ul>
<p>Python is very tolerant in this regard and <code>except:</code> will really catch<br>everything including misspelled names, sys.exit() calls, Ctrl+C interrupts,<br>unittest failures and all kinds of other exceptions that you simply don’t<br>want to catch.</p>
</li>
<li><p>Minimize the amount of code in a <code>try</code>/<code>except</code> block. The larger the body<br>of the <code>try</code>, the more likely that an exception will be raised by a line of<br>code that you didn’t expect to raise an exception. In those cases, the<br><code>try</code>/<code>except</code> block hides a real error.</p>
</li>
<li><p>Use the <code>finally</code> clause to execute code whether or not an exception is<br>raised in the <code>try</code> block. This is often useful for cleanup, i.e., closing a<br>file.</p>
</li>
</ul>
<p><a id="s2.5-global-variables"></a><br><a id="25-global-variables"></a></p>
<p><a id="global-variables"></a></p>
<h3 id="2-5-Global-variables"><a href="#2-5-Global-variables" class="headerlink" title="2.5 Global variables"></a>2.5 Global variables</h3><p>Avoid global variables.</p>
<p><a id="s2.5.1-definition"></a><br><a id="251-definition"></a></p>
<p><a id="global-variables-definition"></a></p>
<h4 id="2-5-1-Definition"><a href="#2-5-1-Definition" class="headerlink" title="2.5.1 Definition"></a>2.5.1 Definition</h4><p>Variables that are declared at the module level or as class attributes.</p>
<p><a id="s2.5.2-pros"></a><br><a id="252-pros"></a></p>
<p><a id="global-variables-pros"></a></p>
<h4 id="2-5-2-Pros"><a href="#2-5-2-Pros" class="headerlink" title="2.5.2 Pros"></a>2.5.2 Pros</h4><p>Occasionally useful.</p>
<p><a id="s2.5.3-cons"></a><br><a id="253-cons"></a></p>
<p><a id="global-variables-cons"></a></p>
<h4 id="2-5-3-Cons"><a href="#2-5-3-Cons" class="headerlink" title="2.5.3 Cons"></a>2.5.3 Cons</h4><p>Has the potential to change module behavior during the import, because<br>assignments to global variables are done when the module is first imported.</p>
<p><a id="s2.5.4-decision"></a><br><a id="254-decision"></a></p>
<p><a id="global-variables-decision"></a></p>
<h4 id="2-5-4-Decision"><a href="#2-5-4-Decision" class="headerlink" title="2.5.4 Decision"></a>2.5.4 Decision</h4><p>Avoid global variables.</p>
<p>While they are technically variables, module-level constants are permitted and<br>encouraged. For example: <code>_MAX_HOLY_HANDGRENADE_COUNT = 3</code>. Constants must be<br>named using all caps with underscores. See <a href="#s3.16-naming">Naming</a> below.</p>
<p>If needed, globals should be declared at the module level and made internal to<br>the module by prepending an <code>_</code> to the name. External access must be done<br>through public module-level functions. See <a href="#s3.16-naming">Naming</a> below.</p>
<p><a id="s2.6-nested"></a><br><a id="26-nested"></a></p>
<p><a id="nested-classes-functions"></a></p>
<h3 id="2-6-Nested-Local-Inner-Classes-and-Functions"><a href="#2-6-Nested-Local-Inner-Classes-and-Functions" class="headerlink" title="2.6 Nested/Local/Inner Classes and Functions"></a>2.6 Nested/Local/Inner Classes and Functions</h3><p>Nested local functions or classes are fine when used to close over a local<br>variable. Inner classes are fine.</p>
<p><a id="s2.6.1-definition"></a><br><a id="261-definition"></a></p>
<p><a id="nested-classes-functions-definition"></a></p>
<h4 id="2-6-1-Definition"><a href="#2-6-1-Definition" class="headerlink" title="2.6.1 Definition"></a>2.6.1 Definition</h4><p>A class can be defined inside of a method, function, or class. A function can be<br>defined inside a method or function. Nested functions have read-only access to<br>variables defined in enclosing scopes.</p>
<p><a id="s2.6.2-pros"></a><br><a id="262-pros"></a></p>
<p><a id="nested-classes-functions-pros"></a></p>
<h4 id="2-6-2-Pros"><a href="#2-6-2-Pros" class="headerlink" title="2.6.2 Pros"></a>2.6.2 Pros</h4><p>Allows definition of utility classes and functions that are only used inside of<br>a very limited scope. Very<br><a href="http://www.google.com/url?sa=D&amp;q=http://en.wikipedia.org/wiki/Abstract_data_type" target="_blank" rel="noopener">ADT</a>-y.<br>Commonly used for implementing decorators.</p>
<p><a id="s2.6.3-cons"></a><br><a id="263-cons"></a></p>
<p><a id="nested-classes-functions-cons"></a></p>
<h4 id="2-6-3-Cons"><a href="#2-6-3-Cons" class="headerlink" title="2.6.3 Cons"></a>2.6.3 Cons</h4><p>Nested functions and classes cannot be directly tested. Nesting can make the<br>outer function longer and less readable.</p>
<p><a id="s2.6.4-decision"></a><br><a id="264-decision"></a></p>
<p><a id="nested-classes-functions-decision"></a></p>
<h4 id="2-6-4-Decision"><a href="#2-6-4-Decision" class="headerlink" title="2.6.4 Decision"></a>2.6.4 Decision</h4><p>They are fine with some caveats. Avoid nested functions or classes except when<br>closing over a local value other than <code>self</code> or <code>cls</code>. Do not nest a function<br>just to hide it from users of a module. Instead, prefix its name with an _ at<br>the module level so that it can still be accessed by tests.</p>
<p><a id="s2.7-comprehensions"></a><br><a id="s2.7-list_comprehensions"></a><br><a id="27-list_comprehensions"></a><br><a id="list_comprehensions"></a><br><a id="list-comprehensions"></a></p>
<p><a id="comprehensions"></a></p>
<h3 id="2-7-Comprehensions-amp-Generator-Expressions"><a href="#2-7-Comprehensions-amp-Generator-Expressions" class="headerlink" title="2.7 Comprehensions &amp; Generator Expressions"></a>2.7 Comprehensions &amp; Generator Expressions</h3><p>Okay to use for simple cases.</p>
<p><a id="s2.7.1-definition"></a><br><a id="271-definition"></a></p>
<p><a id="comprehensions-definition"></a></p>
<h4 id="2-7-1-Definition"><a href="#2-7-1-Definition" class="headerlink" title="2.7.1 Definition"></a>2.7.1 Definition</h4><p>List, Dict, and Set comprehensions as well as generator expressions provide a<br>concise and efficient way to create container types and iterators without<br>resorting to the use of traditional loops, <code>map()</code>, <code>filter()</code>, or <code>lambda</code>.</p>
<p><a id="s2.7.2-pros"></a><br><a id="272-pros"></a></p>
<p><a id="comprehensions-pros"></a></p>
<h4 id="2-7-2-Pros"><a href="#2-7-2-Pros" class="headerlink" title="2.7.2 Pros"></a>2.7.2 Pros</h4><p>Simple comprehensions can be clearer and simpler than other dict, list, or set<br>creation techniques. Generator expressions can be very efficient, since they<br>avoid the creation of a list entirely.</p>
<p><a id="s2.7.3-cons"></a><br><a id="273-cons"></a></p>
<p><a id="comprehensions-cons"></a></p>
<h4 id="2-7-3-Cons"><a href="#2-7-3-Cons" class="headerlink" title="2.7.3 Cons"></a>2.7.3 Cons</h4><p>Complicated comprehensions or generator expressions can be hard to read.</p>
<p><a id="s2.7.4-decision"></a><br><a id="274-decision"></a></p>
<p><a id="comprehensions-decision"></a></p>
<h4 id="2-7-4-Decision"><a href="#2-7-4-Decision" class="headerlink" title="2.7.4 Decision"></a>2.7.4 Decision</h4><p>Okay to use for simple cases. Each portion must fit on one line: mapping<br>expression, <code>for</code> clause, filter expression. Multiple <code>for</code> clauses or filter<br>expressions are not permitted. Use loops instead when things get more<br>complicated.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line">  result = [mapping_expr <span class="keyword">for</span> value <span class="keyword">in</span> iterable <span class="keyword">if</span> filter_expr]</span><br><span class="line"></span><br><span class="line">  result = [&#123;<span class="string">'key'</span>: value&#125; <span class="keyword">for</span> value <span class="keyword">in</span> iterable</span><br><span class="line">            <span class="keyword">if</span> a_long_filter_expression(value)]</span><br><span class="line"></span><br><span class="line">  result = [complicated_transform(x)</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> iterable <span class="keyword">if</span> predicate(x)]</span><br><span class="line"></span><br><span class="line">  descriptive_name = [</span><br><span class="line">      transform(&#123;<span class="string">'key'</span>: key, <span class="string">'value'</span>: value&#125;, color=<span class="string">'black'</span>)</span><br><span class="line">      <span class="keyword">for</span> key, value <span class="keyword">in</span> generate_iterable(some_input)</span><br><span class="line">      <span class="keyword">if</span> complicated_condition_is_met(key, value)</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  result = []</span><br><span class="line">  <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">      <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">          <span class="keyword">if</span> x * y &gt; <span class="number">10</span>:</span><br><span class="line">              result.append((x, y))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;x: complicated_transform(x)</span><br><span class="line">          <span class="keyword">for</span> x <span class="keyword">in</span> long_generator_function(parameter)</span><br><span class="line">          <span class="keyword">if</span> x <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>&#125;</span><br><span class="line"></span><br><span class="line">  squares_generator = (x**<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line">  unique_names = &#123;user.name <span class="keyword">for</span> user <span class="keyword">in</span> users <span class="keyword">if</span> user <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>&#125;</span><br><span class="line"></span><br><span class="line">  eat(jelly_bean <span class="keyword">for</span> jelly_bean <span class="keyword">in</span> jelly_beans</span><br><span class="line">      <span class="keyword">if</span> jelly_bean.color == <span class="string">'black'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line">  result = [complicated_transform(</span><br><span class="line">                x, some_argument=x+<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> iterable <span class="keyword">if</span> predicate(x)]</span><br><span class="line"></span><br><span class="line">  result = [(x, y) <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>) <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">5</span>) <span class="keyword">if</span> x * y &gt; <span class="number">10</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ((x, y, z)</span><br><span class="line">          <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">5</span>)</span><br><span class="line">          <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">5</span>)</span><br><span class="line">          <span class="keyword">if</span> x != y</span><br><span class="line">          <span class="keyword">for</span> z <span class="keyword">in</span> range(<span class="number">5</span>)</span><br><span class="line">          <span class="keyword">if</span> y != z)</span><br></pre></td></tr></table></figure>
<p><a id="s2.8-default-iterators-and-operators"></a></p>
<p><a id="default-iterators-operators"></a></p>
<h3 id="2-8-Default-Iterators-and-Operators"><a href="#2-8-Default-Iterators-and-Operators" class="headerlink" title="2.8 Default Iterators and Operators"></a>2.8 Default Iterators and Operators</h3><p>Use default iterators and operators for types that support them, like lists,<br>dictionaries, and files.</p>
<p><a id="s2.8.1-definition"></a><br><a id="281-definition"></a></p>
<p><a id="default-iterators-operators-definition"></a></p>
<h4 id="2-8-1-Definition"><a href="#2-8-1-Definition" class="headerlink" title="2.8.1 Definition"></a>2.8.1 Definition</h4><p>Container types, like dictionaries and lists, define default iterators and<br>membership test operators (“in” and “not in”).</p>
<p><a id="s2.8.2-pros"></a><br><a id="282-pros"></a></p>
<p><a id="default-iterators-operators-pros"></a></p>
<h4 id="2-8-2-Pros"><a href="#2-8-2-Pros" class="headerlink" title="2.8.2 Pros"></a>2.8.2 Pros</h4><p>The default iterators and operators are simple and efficient. They express the<br>operation directly, without extra method calls. A function that uses default<br>operators is generic. It can be used with any type that supports the operation.</p>
<p><a id="s2.8.3-cons"></a><br><a id="283-cons"></a></p>
<p><a id="default-iterators-operators-cons"></a></p>
<h4 id="2-8-3-Cons"><a href="#2-8-3-Cons" class="headerlink" title="2.8.3 Cons"></a>2.8.3 Cons</h4><p>You can’t tell the type of objects by reading the method names (e.g. <code>has_key()</code><br>means a dictionary). This is also an advantage.</p>
<p><a id="s2.8.4-decision"></a><br><a id="284-decision"></a></p>
<p><a id="default-iterators-operators-decision"></a></p>
<h4 id="2-8-4-Decision"><a href="#2-8-4-Decision" class="headerlink" title="2.8.4 Decision"></a>2.8.4 Decision</h4><p>Use default iterators and operators for types that support them, like lists,<br>dictionaries, and files. The built-in types define iterator methods, too. Prefer<br>these methods to methods that return lists, except that you should not mutate a<br>container while iterating over it.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Yes:  <span class="keyword">for</span> key <span class="keyword">in</span> adict: ...</span><br><span class="line">      <span class="keyword">if</span> key <span class="keyword">not</span> <span class="keyword">in</span> adict: ...</span><br><span class="line">      <span class="keyword">if</span> obj <span class="keyword">in</span> alist: ...</span><br><span class="line">      <span class="keyword">for</span> line <span class="keyword">in</span> afile: ...</span><br><span class="line">      <span class="keyword">for</span> k, v <span class="keyword">in</span> adict.items(): ...</span><br><span class="line">      <span class="keyword">for</span> k, v <span class="keyword">in</span> six.iteritems(adict): ...</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">No:   <span class="keyword">for</span> key <span class="keyword">in</span> adict.keys(): ...</span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">not</span> adict.has_key(key): ...</span><br><span class="line">      <span class="keyword">for</span> line <span class="keyword">in</span> afile.readlines(): ...</span><br><span class="line">      <span class="keyword">for</span> k, v <span class="keyword">in</span> dict.iteritems(): ...</span><br></pre></td></tr></table></figure>
<p><a id="s2.9-generators"></a><br><a id="29-generators"></a></p>
<p><a id="generators"></a></p>
<h3 id="2-9-Generators"><a href="#2-9-Generators" class="headerlink" title="2.9 Generators"></a>2.9 Generators</h3><p>Use generators as needed.</p>
<p><a id="s2.9.1-definition"></a><br><a id="291-definition"></a></p>
<p><a id="generators-definition"></a></p>
<h4 id="2-9-Definition"><a href="#2-9-Definition" class="headerlink" title="2.9 Definition"></a>2.9 Definition</h4><p>A generator function returns an iterator that yields a value each time it<br>executes a yield statement. After it yields a value, the runtime state of the<br>generator function is suspended until the next value is needed.</p>
<p><a id="s2.9.2-pros"></a><br><a id="292-pros"></a></p>
<p><a id="generators-pros"></a></p>
<h4 id="2-9-2-Pros"><a href="#2-9-2-Pros" class="headerlink" title="2.9.2 Pros"></a>2.9.2 Pros</h4><p>Simpler code, because the state of local variables and control flow are<br>preserved for each call. A generator uses less memory than a function that<br>creates an entire list of values at once.</p>
<p><a id="s2.9.3-cons"></a><br><a id="293-cons"></a></p>
<p><a id="generators-cons"></a></p>
<h4 id="2-9-3-Cons"><a href="#2-9-3-Cons" class="headerlink" title="2.9.3 Cons"></a>2.9.3 Cons</h4><p>None.</p>
<p><a id="s2.9.4-decision"></a><br><a id="294-decision"></a></p>
<p><a id="generators-decision"></a></p>
<h4 id="2-9-4-Decision"><a href="#2-9-4-Decision" class="headerlink" title="2.9.4 Decision"></a>2.9.4 Decision</h4><p>Fine. Use “Yields:” rather than “Returns:” in the docstring for generator<br>functions.</p>
<p><a id="s2.10-lambda-functions"></a><br><a id="210-lambda-functions"></a></p>
<p><a id="lambdas"></a></p>
<h3 id="2-10-Lambda-Functions"><a href="#2-10-Lambda-Functions" class="headerlink" title="2.10 Lambda Functions"></a>2.10 Lambda Functions</h3><p>Okay for one-liners. Prefer generator expressions over <code>map()</code> or <code>filter()</code><br>with a <code>lambda</code>.</p>
<p><a id="s2.10.1-definition"></a><br><a id="2101-definition"></a></p>
<p><a id="lambdas-definition"></a></p>
<h4 id="2-10-1-Definition"><a href="#2-10-1-Definition" class="headerlink" title="2.10.1 Definition"></a>2.10.1 Definition</h4><p>Lambdas define anonymous functions in an expression, as opposed to a statement.</p>
<p><a id="s2.10.2-pros"></a><br><a id="2102-pros"></a></p>
<p><a id="lambdas-pros"></a></p>
<h4 id="2-10-2-Pros"><a href="#2-10-2-Pros" class="headerlink" title="2.10.2 Pros"></a>2.10.2 Pros</h4><p>Convenient.</p>
<p><a id="s2.10.3-cons"></a><br><a id="2103-cons"></a></p>
<p><a id="lambdas-cons"></a></p>
<h4 id="2-10-3-Cons"><a href="#2-10-3-Cons" class="headerlink" title="2.10.3 Cons"></a>2.10.3 Cons</h4><p>Harder to read and debug than local functions. The lack of names means stack<br>traces are more difficult to understand. Expressiveness is limited because the<br>function may only contain an expression.</p>
<p><a id="s2.10.4-decision"></a><br><a id="2104-decision"></a></p>
<p><a id="lambdas-decision"></a></p>
<h4 id="2-10-4-Decision"><a href="#2-10-4-Decision" class="headerlink" title="2.10.4 Decision"></a>2.10.4 Decision</h4><p>Okay to use them for one-liners. If the code inside the lambda function is<br>longer than 60-80 chars, it’s probably better to define it as a regular<br><a href="#lexical-scoping">nested function</a>.</p>
<p>For common operations like multiplication, use the functions from the <code>operator</code><br>module instead of lambda functions. For example, prefer <code>operator.mul</code> to<br><code>lambda x, y: x * y</code>.</p>
<p><a id="s2.11-conditional-expressions"></a><br><a id="211-conditional-expressions"></a></p>
<p><a id="conditional-expressions"></a></p>
<h3 id="2-11-Conditional-Expressions"><a href="#2-11-Conditional-Expressions" class="headerlink" title="2.11 Conditional Expressions"></a>2.11 Conditional Expressions</h3><p>Okay for simple cases.</p>
<p><a id="s2.11.1-definition"></a><br><a id="2111-definition"></a></p>
<p><a id="conditional-expressions-definition"></a></p>
<h4 id="2-11-1-Definition"><a href="#2-11-1-Definition" class="headerlink" title="2.11.1 Definition"></a>2.11.1 Definition</h4><p>Conditional expressions (sometimes called a “ternary operator”) are mechanisms<br>that provide a shorter syntax for if statements. For example: <code>x = 1 if cond
else 2</code>.</p>
<p><a id="s2.11.2-pros"></a><br><a id="2112-pros"></a></p>
<p><a id="conditional-expressions-pros"></a></p>
<h4 id="2-11-2-Pros"><a href="#2-11-2-Pros" class="headerlink" title="2.11.2 Pros"></a>2.11.2 Pros</h4><p>Shorter and more convenient than an if statement.</p>
<p><a id="s2.11.3-cons"></a><br><a id="2113-cons"></a></p>
<p><a id="conditional-expressions-cons"></a></p>
<h4 id="2-11-3-Cons"><a href="#2-11-3-Cons" class="headerlink" title="2.11.3 Cons"></a>2.11.3 Cons</h4><p>May be harder to read than an if statement. The condition may be difficult to<br>locate if the expression is long.</p>
<p><a id="s2.11.4-decision"></a><br><a id="2114-decision"></a></p>
<p><a id="conditional-expressions-decision"></a></p>
<h4 id="2-11-4-Decision"><a href="#2-11-4-Decision" class="headerlink" title="2.11.4 Decision"></a>2.11.4 Decision</h4><p>Okay to use for simple cases. Each portion must fit on one line:<br>true-expression, if-expression, else-expression. Use a complete if statement<br>when things get more complicated.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line">    one_line = <span class="string">'yes'</span> <span class="keyword">if</span> predicate(value) <span class="keyword">else</span> <span class="string">'no'</span></span><br><span class="line">    slightly_split = (<span class="string">'yes'</span> <span class="keyword">if</span> predicate(value)</span><br><span class="line">                      <span class="keyword">else</span> <span class="string">'no, nein, nyet'</span>)</span><br><span class="line">    the_longest_ternary_style_that_can_be_done = (</span><br><span class="line">        <span class="string">'yes, true, affirmative, confirmed, correct'</span></span><br><span class="line">        <span class="keyword">if</span> predicate(value)</span><br><span class="line">        <span class="keyword">else</span> <span class="string">'no, false, negative, nay'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line">    bad_line_breaking = (<span class="string">'yes'</span> <span class="keyword">if</span> predicate(value) <span class="keyword">else</span></span><br><span class="line">                         <span class="string">'no'</span>)</span><br><span class="line">    portion_too_long = (<span class="string">'yes'</span></span><br><span class="line">                        <span class="keyword">if</span> some_long_module.some_long_predicate_function(</span><br><span class="line">                            really_long_variable_name)</span><br><span class="line">                        <span class="keyword">else</span> <span class="string">'no, false, negative, nay'</span>)</span><br></pre></td></tr></table></figure>
<p><a id="s2.12-default-argument-values"></a><br><a id="212-default-argument-values"></a></p>
<p><a id="default-arguments"></a></p>
<h3 id="2-12-Default-Argument-Values"><a href="#2-12-Default-Argument-Values" class="headerlink" title="2.12 Default Argument Values"></a>2.12 Default Argument Values</h3><p>Okay in most cases.</p>
<p><a id="s2.12.1-definition"></a><br><a id="2121-definition"></a></p>
<p><a id="default-arguments-definition"></a></p>
<h4 id="2-12-1-Definition"><a href="#2-12-1-Definition" class="headerlink" title="2.12.1 Definition"></a>2.12.1 Definition</h4><p>You can specify values for variables at the end of a function’s parameter list,<br>e.g., <code>def foo(a, b=0):</code>. If <code>foo</code> is called with only one argument, <code>b</code> is set<br>to 0. If it is called with two arguments, <code>b</code> has the value of the second<br>argument.</p>
<p><a id="s2.12.2-pros"></a><br><a id="2122-pros"></a></p>
<p><a id="default-arguments-pros"></a></p>
<h4 id="2-12-2-Pros"><a href="#2-12-2-Pros" class="headerlink" title="2.12.2 Pros"></a>2.12.2 Pros</h4><p>Often you have a function that uses lots of default values, but on rare<br>occasions you want to override the defaults. Default argument values provide an<br>easy way to do this, without having to define lots of functions for the rare<br>exceptions. As Python does not support overloaded methods/functions, default<br>arguments are an easy way of “faking” the overloading behavior.</p>
<p><a id="s2.12.3-cons"></a><br><a id="2123-cons"></a></p>
<p><a id="default-arguments-cons"></a></p>
<h4 id="2-12-3-Cons"><a href="#2-12-3-Cons" class="headerlink" title="2.12.3 Cons"></a>2.12.3 Cons</h4><p>Default arguments are evaluated once at module load time. This may cause<br>problems if the argument is a mutable object such as a list or a dictionary. If<br>the function modifies the object (e.g., by appending an item to a list), the<br>default value is modified.</p>
<p><a id="s2.12.4-decision"></a><br><a id="2124-decision"></a></p>
<p><a id="default-arguments-decision"></a></p>
<h4 id="2-12-4-Decision"><a href="#2-12-4-Decision" class="headerlink" title="2.12.4 Decision"></a>2.12.4 Decision</h4><p>Okay to use with the following caveat:</p>
<p>Do not use mutable objects as default values in the function or method<br>definition.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Yes: <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(a, b=None)</span>:</span></span><br><span class="line">         <span class="keyword">if</span> b <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">             b = []</span><br><span class="line">Yes: <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(a, b: Optional[Sequence] = None)</span>:</span></span><br><span class="line">         <span class="keyword">if</span> b <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">             b = []</span><br><span class="line">Yes: <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(a, b: Sequence = <span class="params">()</span>)</span>:</span>  <span class="comment"># Empty tuple OK since tuples are immutable</span></span><br><span class="line">         ...</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">No:  <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(a, b=[])</span>:</span></span><br><span class="line">         ...</span><br><span class="line">No:  <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(a, b=time.time<span class="params">()</span>)</span>:</span>  <span class="comment"># The time the module was loaded???</span></span><br><span class="line">         ...</span><br><span class="line">No:  <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(a, b=FLAGS.my_thing)</span>:</span>  <span class="comment"># sys.argv has not yet been parsed...</span></span><br><span class="line">         ...</span><br><span class="line">No:  <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(a, b: Mapping = &#123;&#125;)</span>:</span>  <span class="comment"># Could still get passed to unchecked code</span></span><br><span class="line">         ...</span><br></pre></td></tr></table></figure>
<p><a id="s2.13-properties"></a><br><a id="213-properties"></a></p>
<p><a id="properties"></a></p>
<h3 id="2-13-Properties"><a href="#2-13-Properties" class="headerlink" title="2.13 Properties"></a>2.13 Properties</h3><p>Use properties for accessing or setting data where you would normally have used<br>simple, lightweight accessor or setter methods.</p>
<p><a id="s2.13.1-definition"></a><br><a id="2131-definition"></a></p>
<p><a id="properties-definition"></a></p>
<h4 id="2-13-1-Definition"><a href="#2-13-1-Definition" class="headerlink" title="2.13.1 Definition"></a>2.13.1 Definition</h4><p>A way to wrap method calls for getting and setting an attribute as a standard<br>attribute access when the computation is lightweight.</p>
<p><a id="s2.13.2-pros"></a><br><a id="2132-pros"></a></p>
<p><a id="properties-pros"></a></p>
<h4 id="2-13-2-Pros"><a href="#2-13-2-Pros" class="headerlink" title="2.13.2 Pros"></a>2.13.2 Pros</h4><p>Readability is increased by eliminating explicit get and set method calls for<br>simple attribute access. Allows calculations to be lazy. Considered the Pythonic<br>way to maintain the interface of a class. In terms of performance, allowing<br>properties bypasses needing trivial accessor methods when a direct variable<br>access is reasonable. This also allows accessor methods to be added in the<br>future without breaking the interface.</p>
<p><a id="s2.13.3-cons"></a><br><a id="2133-cons"></a></p>
<p><a id="properties-cons"></a></p>
<h4 id="2-13-3-Cons"><a href="#2-13-3-Cons" class="headerlink" title="2.13.3 Cons"></a>2.13.3 Cons</h4><p>Can hide side-effects much like operator overloading. Can be confusing for<br>subclasses.</p>
<p><a id="s2.13.4-decision"></a><br><a id="2134-decision"></a></p>
<p><a id="properties-decision"></a></p>
<h4 id="2-13-4-Decision"><a href="#2-13-4-Decision" class="headerlink" title="2.13.4 Decision"></a>2.13.4 Decision</h4><p>Use properties in new code to access or set data where you would normally have<br>used lightweight accessor or setter methods. Properties should be created with<br>the <code>@property</code> <a href="#s2.17-function-and-method-decorators">decorator</a>.</p>
<p>Inheritance with properties can be non-obvious if the property itself is not<br>overridden. Thus one must make sure that accessor methods are called indirectly<br>to ensure methods overridden in subclasses are called by the property (using the<br><a href="https://en.wikipedia.org/wiki/Template_method_pattern" target="_blank" rel="noopener">template method design pattern</a>).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Yes: <span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">     <span class="class"><span class="keyword">class</span> <span class="title">Square</span>:</span></span><br><span class="line">         <span class="string">"""A square with two properties: a writable area and a read-only perimeter.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         To use:</span></span><br><span class="line"><span class="string">         &gt;&gt;&gt; sq = Square(3)</span></span><br><span class="line"><span class="string">         &gt;&gt;&gt; sq.area</span></span><br><span class="line"><span class="string">         9</span></span><br><span class="line"><span class="string">         &gt;&gt;&gt; sq.perimeter</span></span><br><span class="line"><span class="string">         12</span></span><br><span class="line"><span class="string">         &gt;&gt;&gt; sq.area = 16</span></span><br><span class="line"><span class="string">         &gt;&gt;&gt; sq.side</span></span><br><span class="line"><span class="string">         4</span></span><br><span class="line"><span class="string">         &gt;&gt;&gt; sq.perimeter</span></span><br><span class="line"><span class="string">         16</span></span><br><span class="line"><span class="string">         """</span></span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, side: float)</span>:</span></span><br><span class="line">             self.side = side</span><br><span class="line"></span><br><span class="line"><span class="meta">         @property</span></span><br><span class="line">         <span class="function"><span class="keyword">def</span> <span class="title">area</span><span class="params">(self)</span> -&gt; float:</span></span><br><span class="line">             <span class="string">"""Area of the square."""</span></span><br><span class="line">             <span class="keyword">return</span> self._get_area()</span><br><span class="line"></span><br><span class="line"><span class="meta">         @area.setter</span></span><br><span class="line">         <span class="function"><span class="keyword">def</span> <span class="title">area</span><span class="params">(self, area: float)</span>:</span></span><br><span class="line">             self._set_area(area)</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">def</span> <span class="title">_get_area</span><span class="params">(self)</span> -&gt; float:</span></span><br><span class="line">             <span class="string">"""Indirect accessor to calculate the 'area' property."""</span></span><br><span class="line">             <span class="keyword">return</span> self.side ** <span class="number">2</span></span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">def</span> <span class="title">_set_area</span><span class="params">(self, area: float)</span>:</span></span><br><span class="line">             <span class="string">"""Indirect setter to set the 'area' property."""</span></span><br><span class="line">             self.side = math.sqrt(area)</span><br><span class="line"></span><br><span class="line"><span class="meta">         @property</span></span><br><span class="line">         <span class="function"><span class="keyword">def</span> <span class="title">perimeter</span><span class="params">(self)</span> -&gt; float:</span></span><br><span class="line">             <span class="keyword">return</span> self.side * <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p><a id="s2.14-truefalse-evaluations"></a><br><a id="214-truefalse-evaluations"></a></p>
<p><a id="truefalse-evaluations"></a></p>
<h3 id="2-14-True-False-Evaluations"><a href="#2-14-True-False-Evaluations" class="headerlink" title="2.14 True/False Evaluations"></a>2.14 True/False Evaluations</h3><p>Use the “implicit” false if at all possible.</p>
<p><a id="s2.14.1-definition"></a><br><a id="2141-definition"></a></p>
<p><a id="truefalse-evaluations-definition"></a></p>
<h4 id="2-14-1-Definition"><a href="#2-14-1-Definition" class="headerlink" title="2.14.1 Definition"></a>2.14.1 Definition</h4><p>Python evaluates certain values as <code>False</code> when in a boolean context. A quick<br>“rule of thumb” is that all “empty” values are considered false, so <code>0, None,
[], {}, &#39;&#39;</code> all evaluate as false in a boolean context.</p>
<p><a id="s2.14.2-pros"></a><br><a id="2142-pros"></a></p>
<p><a id="truefalse-evaluations-pros"></a></p>
<h4 id="2-14-2-Pros"><a href="#2-14-2-Pros" class="headerlink" title="2.14.2 Pros"></a>2.14.2 Pros</h4><p>Conditions using Python booleans are easier to read and less error-prone. In<br>most cases, they’re also faster.</p>
<p><a id="s2.14.3-cons"></a><br><a id="2143-cons"></a></p>
<p><a id="truefalse-evaluations-cons"></a></p>
<h4 id="2-14-3-Cons"><a href="#2-14-3-Cons" class="headerlink" title="2.14.3 Cons"></a>2.14.3 Cons</h4><p>May look strange to C/C++ developers.</p>
<p><a id="s2.14.4-decision"></a><br><a id="2144-decision"></a></p>
<p><a id="truefalse-evaluations-decision"></a></p>
<h4 id="2-14-4-Decision"><a href="#2-14-4-Decision" class="headerlink" title="2.14.4 Decision"></a>2.14.4 Decision</h4><p>Use the “implicit” false if possible, e.g., <code>if foo:</code> rather than <code>if foo !=
[]:</code>. There are a few caveats that you should keep in mind though:</p>
<ul>
<li><p>Always use <code>if foo is None:</code> (or <code>is not None</code>) to check for a <code>None</code> value.<br>E.g., when testing whether a variable or argument that defaults to <code>None</code><br>was set to some other value. The other value might be a value that’s false<br>in a boolean context!</p>
</li>
<li><p>Never compare a boolean variable to <code>False</code> using <code>==</code>. Use <code>if not x:</code><br>instead. If you need to distinguish <code>False</code> from <code>None</code> then chain the<br>expressions, such as <code>if not x and x is not None:</code>.</p>
</li>
<li><p>For sequences (strings, lists, tuples), use the fact that empty sequences<br>are false, so <code>if seq:</code> and <code>if not seq:</code> are preferable to <code>if len(seq):</code><br>and <code>if not len(seq):</code> respectively.</p>
</li>
<li><p>When handling integers, implicit false may involve more risk than benefit<br>(i.e., accidentally handling <code>None</code> as 0). You may compare a value which is<br>known to be an integer (and is not the result of <code>len()</code>) against the<br>integer 0.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Yes: <span class="keyword">if</span> <span class="keyword">not</span> users:</span><br><span class="line">         print(<span class="string">'no users'</span>)</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> foo == <span class="number">0</span>:</span><br><span class="line">         self.handle_zero()</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> i % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">         self.handle_multiple_of_ten()</span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x=None)</span>:</span></span><br><span class="line">         <span class="keyword">if</span> x <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">             x = []</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">No:  <span class="keyword">if</span> len(users) == <span class="number">0</span>:</span><br><span class="line">         print(<span class="string">'no users'</span>)</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> foo <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> <span class="keyword">not</span> foo:</span><br><span class="line">         self.handle_zero()</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> <span class="keyword">not</span> i % <span class="number">10</span>:</span><br><span class="line">         self.handle_multiple_of_ten()</span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x=None)</span>:</span></span><br><span class="line">         x = x <span class="keyword">or</span> []</span><br></pre></td></tr></table></figure>
</li>
<li><p>Note that <code>&#39;0&#39;</code> (i.e., <code>0</code> as string) evaluates to true.</p>
</li>
</ul>
<p><a id="s2.16-lexical-scoping"></a><br><a id="216-lexical-scoping"></a></p>
<p><a id="lexical-scoping"></a></p>
<h3 id="2-16-Lexical-Scoping"><a href="#2-16-Lexical-Scoping" class="headerlink" title="2.16 Lexical Scoping"></a>2.16 Lexical Scoping</h3><p>Okay to use.</p>
<p><a id="s2.16.1-definition"></a><br><a id="2161-definition"></a></p>
<p><a id="lexical-scoping-definition"></a></p>
<h4 id="2-16-1-Definition"><a href="#2-16-1-Definition" class="headerlink" title="2.16.1 Definition"></a>2.16.1 Definition</h4><p>A nested Python function can refer to variables defined in enclosing functions,<br>but cannot assign to them. Variable bindings are resolved using lexical scoping,<br>that is, based on the static program text. Any assignment to a name in a block<br>will cause Python to treat all references to that name as a local variable, even<br>if the use precedes the assignment. If a global declaration occurs, the name is<br>treated as a global variable.</p>
<p>An example of the use of this feature is:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_adder</span><span class="params">(summand1: float)</span> -&gt; Callable[[float], float]:</span></span><br><span class="line">    <span class="string">"""Returns a function that adds numbers to a given number."""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adder</span><span class="params">(summand2: float)</span> -&gt; float:</span></span><br><span class="line">        <span class="keyword">return</span> summand1 + summand2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> adder</span><br></pre></td></tr></table></figure>
<p><a id="s2.16.2-pros"></a><br><a id="2162-pros"></a></p>
<p><a id="lexical-scoping-pros"></a></p>
<h4 id="2-16-2-Pros"><a href="#2-16-2-Pros" class="headerlink" title="2.16.2 Pros"></a>2.16.2 Pros</h4><p>Often results in clearer, more elegant code. Especially comforting to<br>experienced Lisp and Scheme (and Haskell and ML and …) programmers.</p>
<p><a id="s2.16.3-cons"></a><br><a id="2163-cons"></a></p>
<p><a id="lexical-scoping-cons"></a></p>
<h4 id="2-16-3-Cons"><a href="#2-16-3-Cons" class="headerlink" title="2.16.3 Cons"></a>2.16.3 Cons</h4><p>Can lead to confusing bugs. Such as this example based on<br><a href="http://www.google.com/url?sa=D&amp;q=http://www.python.org/dev/peps/pep-0227/" target="_blank" rel="noopener">PEP-0227</a>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">4</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(x: Iterable[int])</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">()</span>:</span></span><br><span class="line">        print(i, end=<span class="string">''</span>)</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    <span class="comment"># A bunch of code here</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> x:  <span class="comment"># Ah, i *is* local to foo, so this is what bar sees</span></span><br><span class="line">        print(i, end=<span class="string">''</span>)</span><br><span class="line">    bar()</span><br></pre></td></tr></table></figure>
<p>So <code>foo([1, 2, 3])</code> will print <code>1 2 3 3</code>,<br>not <code>1 2 3 4</code>.</p>
<p><a id="s2.16.4-decision"></a><br><a id="2164-decision"></a></p>
<p><a id="lexical-scoping-decision"></a></p>
<h4 id="2-16-4-Decision"><a href="#2-16-4-Decision" class="headerlink" title="2.16.4 Decision"></a>2.16.4 Decision</h4><p>Okay to use.</p>
<p><a id="s2.17-function-and-method-decorators"></a><br><a id="217-function-and-method-decorators"></a><br><a id="function-and-method-decorators"></a></p>
<p><a id="decorators"></a></p>
<h3 id="2-17-Function-and-Method-Decorators"><a href="#2-17-Function-and-Method-Decorators" class="headerlink" title="2.17 Function and Method Decorators"></a>2.17 Function and Method Decorators</h3><p>Use decorators judiciously when there is a clear advantage. Avoid <code>staticmethod</code><br>and limit use of <code>classmethod</code>.</p>
<p><a id="s2.17.1-definition"></a><br><a id="2171-definition"></a></p>
<p><a id="decorators-definition"></a></p>
<h4 id="2-17-1-Definition"><a href="#2-17-1-Definition" class="headerlink" title="2.17.1 Definition"></a>2.17.1 Definition</h4><p><a href="https://docs.python.org/3/glossary.html#term-decorator" target="_blank" rel="noopener">Decorators for Functions and Methods</a><br>(a.k.a “the <code>@</code> notation”). One common decorator is <code>@property</code>, used for<br>converting ordinary methods into dynamically computed attributes. However, the<br>decorator syntax allows for user-defined decorators as well. Specifically, for<br>some function <code>my_decorator</code>, this:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line"><span class="meta">    @my_decorator</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">method</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># method body ...</span></span><br></pre></td></tr></table></figure>
<p>is equivalent to:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">method</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># method body ...</span></span><br><span class="line">    method = my_decorator(method)</span><br></pre></td></tr></table></figure>
<p><a id="s2.17.2-pros"></a><br><a id="2172-pros"></a></p>
<p><a id="decorators-pros"></a></p>
<h4 id="2-17-2-Pros"><a href="#2-17-2-Pros" class="headerlink" title="2.17.2 Pros"></a>2.17.2 Pros</h4><p>Elegantly specifies some transformation on a method; the transformation might<br>eliminate some repetitive code, enforce invariants, etc.</p>
<p><a id="s2.17.3-cons"></a><br><a id="2173-cons"></a></p>
<p><a id="decorators-cons"></a></p>
<h4 id="2-17-3-Cons"><a href="#2-17-3-Cons" class="headerlink" title="2.17.3 Cons"></a>2.17.3 Cons</h4><p>Decorators can perform arbitrary operations on a function’s arguments or return<br>values, resulting in surprising implicit behavior. Additionally, decorators<br>execute at import time. Failures in decorator code are pretty much impossible to<br>recover from.</p>
<p><a id="s2.17.4-decision"></a><br><a id="2174-decision"></a></p>
<p><a id="decorators-decision"></a></p>
<h4 id="2-17-4-Decision"><a href="#2-17-4-Decision" class="headerlink" title="2.17.4 Decision"></a>2.17.4 Decision</h4><p>Use decorators judiciously when there is a clear advantage. Decorators should<br>follow the same import and naming guidelines as functions. Decorator pydoc<br>should clearly state that the function is a decorator. Write unit tests for<br>decorators.</p>
<p>Avoid external dependencies in the decorator itself (e.g. don’t rely on files,<br>sockets, database connections, etc.), since they might not be available when the<br>decorator runs (at import time, perhaps from <code>pydoc</code> or other tools). A<br>decorator that is called with valid parameters should (as much as possible) be<br>guaranteed to succeed in all cases.</p>
<p>Decorators are a special case of “top level code” - see <a href="#s3.17-main">main</a> for<br>more discussion.</p>
<p>Never use <code>staticmethod</code> unless forced to in order to integrate with an API<br>defined in an existing library. Write a module level function instead.</p>
<p>Use <code>classmethod</code> only when writing a named constructor or a class-specific<br>routine that modifies necessary global state such as a process-wide cache.</p>
<p><a id="s2.18-threading"></a><br><a id="218-threading"></a></p>
<p><a id="threading"></a></p>
<h3 id="2-18-Threading"><a href="#2-18-Threading" class="headerlink" title="2.18 Threading"></a>2.18 Threading</h3><p>Do not rely on the atomicity of built-in types.</p>
<p>While Python’s built-in data types such as dictionaries appear to have atomic<br>operations, there are corner cases where they aren’t atomic (e.g. if <code>__hash__</code><br>or <code>__eq__</code> are implemented as Python methods) and their atomicity should not be<br>relied upon. Neither should you rely on atomic variable assignment (since this<br>in turn depends on dictionaries).</p>
<p>Use the Queue module’s <code>Queue</code> data type as the preferred way to communicate<br>data between threads. Otherwise, use the threading module and its locking<br>primitives. Prefer condition variables and <code>threading.Condition</code> instead of<br>using lower-level locks.</p>
<p><a id="s2.19-power-features"></a><br><a id="219-power-features"></a></p>
<p><a id="power-features"></a></p>
<h3 id="2-19-Power-Features"><a href="#2-19-Power-Features" class="headerlink" title="2.19 Power Features"></a>2.19 Power Features</h3><p>Avoid these features.</p>
<p><a id="s2.19.1-definition"></a><br><a id="2191-definition"></a></p>
<p><a id="power-features-definition"></a></p>
<h4 id="2-19-1-Definition"><a href="#2-19-1-Definition" class="headerlink" title="2.19.1 Definition"></a>2.19.1 Definition</h4><p>Python is an extremely flexible language and gives you many fancy features such<br>as custom metaclasses, access to bytecode, on-the-fly compilation, dynamic<br>inheritance, object reparenting, import hacks, reflection (e.g. some uses of<br><code>getattr()</code>), modification of system internals, <code>__del__</code> methods implementing<br>customized cleanup, etc.</p>
<p><a id="s2.19.2-pros"></a><br><a id="2192-pros"></a></p>
<p><a id="power-features-pros"></a></p>
<h4 id="2-19-2-Pros"><a href="#2-19-2-Pros" class="headerlink" title="2.19.2 Pros"></a>2.19.2 Pros</h4><p>These are powerful language features. They can make your code more compact.</p>
<p><a id="s2.19.3-cons"></a><br><a id="2193-cons"></a></p>
<p><a id="power-features-cons"></a></p>
<h4 id="2-19-3-Cons"><a href="#2-19-3-Cons" class="headerlink" title="2.19.3 Cons"></a>2.19.3 Cons</h4><p>It’s very tempting to use these “cool” features when they’re not absolutely<br>necessary. It’s harder to read, understand, and debug code that’s using unusual<br>features underneath. It doesn’t seem that way at first (to the original author),<br>but when revisiting the code, it tends to be more difficult than code that is<br>longer but is straightforward.</p>
<p><a id="s2.19.4-decision"></a><br><a id="2194-decision"></a></p>
<p><a id="power-features-decision"></a></p>
<h4 id="2-19-4-Decision"><a href="#2-19-4-Decision" class="headerlink" title="2.19.4 Decision"></a>2.19.4 Decision</h4><p>Avoid these features in your code.</p>
<p>Standard library modules and classes that internally use these features are okay<br>to use (for example, <code>abc.ABCMeta</code>, <code>dataclasses</code>, and <code>enum</code>).</p>
<p><a id="s2.20-modern-python"></a><br><a id="220-modern-python"></a></p>
<p><a id="modern-python"></a></p>
<h3 id="2-20-Modern-Python-from-future-imports"><a href="#2-20-Modern-Python-from-future-imports" class="headerlink" title="2.20 Modern Python: from __future__ imports"></a>2.20 Modern Python: from __future__ imports</h3><p>New language version semantic changes may be gated behind a special future<br>import to enable them on a per-file basis within earlier runtimes.</p>
<p><a id="s2.20.1-definition"></a><br><a id="2201-definition"></a></p>
<p><a id="modern-python-definition"></a></p>
<h4 id="2-20-1-Definition"><a href="#2-20-1-Definition" class="headerlink" title="2.20.1 Definition"></a>2.20.1 Definition</h4><p>Being able to turn on some of the more modern features via <code>from __future__
import</code> statements allows early use of features from expected future Python<br>versions.</p>
<p><a id="s2.20.2-pros"></a><br><a id="2202-pros"></a></p>
<p><a id="modern-python-pros"></a></p>
<h4 id="2-20-2-Pros"><a href="#2-20-2-Pros" class="headerlink" title="2.20.2 Pros"></a>2.20.2 Pros</h4><p>This has proven to make runtime version upgrades smoother as changes can be made<br>on a per-file basis while declaring compatibility and preventing regressions<br>within those files. Modern code is more maintainable as it is less likely to<br>accumulate technical debt that will be problematic during future runtime<br>upgrades.</p>
<p><a id="s2.20.3-cons"></a><br><a id="2203-cons"></a></p>
<p><a id="modern-python-cons"></a></p>
<h4 id="2-20-3-Cons"><a href="#2-20-3-Cons" class="headerlink" title="2.20.3 Cons"></a>2.20.3 Cons</h4><p>Such code may not work on very old interpreter versions prior to the<br>introduction of the needed future statement. The need for this is more common in<br>projects supporting an extremely wide variety of environments.</p>
<p><a id="s2.20.4-decision"></a><br><a id="2204-decision"></a></p>
<p><a id="modern-python-decision"></a></p>
<h4 id="2-20-4-Decision"><a href="#2-20-4-Decision" class="headerlink" title="2.20.4 Decision"></a>2.20.4 Decision</h4><h5 id="from-future-imports"><a href="#from-future-imports" class="headerlink" title="from __future__ imports"></a>from __future__ imports</h5><p>Use of <code>from __future__ import</code> statements is encouraged. It allows a given<br>source file to start using more modern Python syntax features today. Once you no<br>longer need to run on a version where the features are hidden behind a<br><code>__future__</code> import, feel free to remove those lines.</p>
<p>In code that may execute on versions as old as 3.5 rather than &gt;= 3.7, import:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> generator_stop</span><br></pre></td></tr></table></figure>
<p>For legacy code with the burden of continuing to support 2.7, import:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> absolute_import</span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br></pre></td></tr></table></figure>
<p>For more information read the<br><a href="https://docs.python.org/3/library/__future__.html" target="_blank" rel="noopener">Python future statement definitions</a><br>documentation.</p>
<p>Please don’t remove these imports until you are confident the code is only ever<br>used in a sufficiently modern environment. Even if you do not currently use the<br>feature a specific future import enables in your code today, keeping it in place<br>in the file prevents later modifications of the code from inadvertently<br>depending on the older behavior.</p>
<p>Use other <code>from __future__</code> import statements as you see fit. We did not include<br><code>unicode_literals</code> in our recommendations for 2.7 as it was not a clear win due<br>to implicit default codec conversion consequences it introduced in many places<br>within 2.7. Most dual-version 2-and-3 code was better off with explicit use of<br><code>b&#39;&#39;</code> and <code>u&#39;&#39;</code> bytes and unicode string literals where necessary.</p>
<h5 id="The-six-future-and-past-libraries"><a href="#The-six-future-and-past-libraries" class="headerlink" title="The six, future, and past libraries"></a>The six, future, and past libraries</h5><p>When your project still needs to support use under both Python 2 and 3, use the<br><a href="https://pypi.org/project/six/" target="_blank" rel="noopener">six</a>,<br><a href="https://pypi.org/project/future/" target="_blank" rel="noopener">future</a>, and<br><a href="https://pypi.org/project/past/" target="_blank" rel="noopener">past</a> libraries as you see fit. They exist to<br>make your code cleaner and life easier.</p>
<p><a id="s2.21-type-annotated-code"></a><br><a id="s2.21-typed-code"></a><br><a id="221-type-annotated-code"></a><br><a id="typed-code"></a></p>
<p><a id="typed-code"></a></p>
<h3 id="2-21-Type-Annotated-Code"><a href="#2-21-Type-Annotated-Code" class="headerlink" title="2.21 Type Annotated Code"></a>2.21 Type Annotated Code</h3><p>You can annotate Python 3 code with type hints according to<br><a href="https://www.python.org/dev/peps/pep-0484/" target="_blank" rel="noopener">PEP-484</a>, and type-check the code at<br>build time with a type checking tool like <a href="https://github.com/google/pytype" target="_blank" rel="noopener">pytype</a>.</p>
<p>Type annotations can be in the source or in a<br><a href="https://www.python.org/dev/peps/pep-0484/#stub-files" target="_blank" rel="noopener">stub pyi file</a>. Whenever<br>possible, annotations should be in the source. Use pyi files for third-party or<br>extension modules.</p>
<p><a id="s2.21.1-definition"></a><br><a id="2211-definition"></a></p>
<p><a id="typed-code-definition"></a></p>
<h4 id="2-21-1-Definition"><a href="#2-21-1-Definition" class="headerlink" title="2.21.1 Definition"></a>2.21.1 Definition</h4><p>Type annotations (or “type hints”) are for function or method arguments and<br>return values:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(a: int)</span> -&gt; List[int]:</span></span><br></pre></td></tr></table></figure>
<p>You can also declare the type of a variable using similar<br><a href="https://www.python.org/dev/peps/pep-0526/" target="_blank" rel="noopener">PEP-526</a> syntax:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a: SomeType = some_func()</span><br></pre></td></tr></table></figure>
<p>Or by using a type comment in code that must support legacy Python versions.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = some_func()  <span class="comment"># type: SomeType</span></span><br></pre></td></tr></table></figure>
<p><a id="s2.21.2-pros"></a><br><a id="2212-pros"></a></p>
<p><a id="typed-code-pros"></a></p>
<h4 id="2-21-2-Pros"><a href="#2-21-2-Pros" class="headerlink" title="2.21.2 Pros"></a>2.21.2 Pros</h4><p>Type annotations improve the readability and maintainability of your code. The<br>type checker will convert many runtime errors to build-time errors, and reduce<br>your ability to use <a href="#power-features">Power Features</a>.</p>
<p><a id="s2.21.3-cons"></a><br><a id="2213-cons"></a></p>
<p><a id="typed-code-cons"></a></p>
<h4 id="2-21-3-Cons"><a href="#2-21-3-Cons" class="headerlink" title="2.21.3 Cons"></a>2.21.3 Cons</h4><p>You will have to keep the type declarations up to date.<br>You might see type errors that you think are<br>valid code. Use of a<br><a href="https://github.com/google/pytype" target="_blank" rel="noopener">type checker</a><br>may reduce your ability to use <a href="#power-features">Power Features</a>.</p>
<p><a id="s2.21.4-decision"></a><br><a id="2214-decision"></a></p>
<p><a id="typed-code-decision"></a></p>
<h4 id="2-21-4-Decision"><a href="#2-21-4-Decision" class="headerlink" title="2.21.4 Decision"></a>2.21.4 Decision</h4><p>You are strongly encouraged to enable Python type analysis when updating code.<br>When adding or modifying public APIs, include type annotations and enable<br>checking via pytype in the build system. As static analysis is relatively new to<br>Python, we acknowledge that undesired side-effects (such as<br>wrongly<br>inferred types) may prevent adoption by some projects. In those situations,<br>authors are encouraged to add a comment with a TODO or link to a bug describing<br>the issue(s) currently preventing type annotation adoption in the BUILD file or<br>in the code itself as appropriate.</p>
<p><a id="s3-python-style-rules"></a><br><a id="3-python-style-rules"></a></p>
<p><a id="python-style-rules"></a></p>
<h2 id="3-Python-Style-Rules"><a href="#3-Python-Style-Rules" class="headerlink" title="3 Python Style Rules"></a>3 Python Style Rules</h2><p><a id="s3.1-semicolons"></a><br><a id="31-semicolons"></a></p>
<p><a id="semicolons"></a></p>
<h3 id="3-1-Semicolons"><a href="#3-1-Semicolons" class="headerlink" title="3.1 Semicolons"></a>3.1 Semicolons</h3><p>Do not terminate your lines with semicolons, and do not use semicolons to put<br>two statements on the same line.</p>
<p><a id="s3.2-line-length"></a><br><a id="32-line-length"></a></p>
<p><a id="line-length"></a></p>
<h3 id="3-2-Line-length"><a href="#3-2-Line-length" class="headerlink" title="3.2 Line length"></a>3.2 Line length</h3><p>Maximum line length is <em>80 characters</em>.</p>
<p>Explicit exceptions to the 80 character limit:</p>
<ul>
<li>Long import statements.</li>
<li>URLs, pathnames, or long flags in comments.</li>
<li>Long string module level constants not containing whitespace that would be<br>inconvenient to split across lines such as URLs or pathnames.<ul>
<li>Pylint disable comments. (e.g.: <code># pylint: disable=invalid-name</code>)</li>
</ul>
</li>
</ul>
<p>Do not use backslash line continuation except for <code>with</code> statements requiring<br>three or more context managers.</p>
<p>Make use of Python’s<br><a href="http://docs.python.org/reference/lexical_analysis.html#implicit-line-joining" target="_blank" rel="noopener">implicit line joining inside parentheses, brackets and braces</a>.<br>If necessary, you can add an extra pair of parentheses around an expression.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Yes: foo_bar(self, width, height, color=<span class="string">'black'</span>, design=<span class="keyword">None</span>, x=<span class="string">'foo'</span>,</span><br><span class="line">             emphasis=<span class="keyword">None</span>, highlight=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> (width == <span class="number">0</span> <span class="keyword">and</span> height == <span class="number">0</span> <span class="keyword">and</span></span><br><span class="line">         color == <span class="string">'red'</span> <span class="keyword">and</span> emphasis == <span class="string">'strong'</span>):</span><br></pre></td></tr></table></figure>
<p>When a literal string won’t fit on a single line, use parentheses for implicit<br>line joining.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = (<span class="string">'This will build a very long long '</span></span><br><span class="line">     <span class="string">'long long long long long long string'</span>)</span><br></pre></td></tr></table></figure>
<p>Within comments, put long URLs on their own line if necessary.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Yes:  <span class="comment"># See details at</span></span><br><span class="line">      <span class="comment"># http://www.example.com/us/developer/documentation/api/content/v2.0/csv_file_name_extension_full_specification.html</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">No:  <span class="comment"># See details at</span></span><br><span class="line">     <span class="comment"># http://www.example.com/us/developer/documentation/api/content/\</span></span><br><span class="line">     <span class="comment"># v2.0/csv_file_name_extension_full_specification.html</span></span><br></pre></td></tr></table></figure>
<p>It is permissible to use backslash continuation when defining a <code>with</code> statement<br>whose expressions span three or more lines. For two lines of expressions, use a<br>nested <code>with</code> statement:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Yes:  <span class="keyword">with</span> very_long_first_expression_function() <span class="keyword">as</span> spam, \</span><br><span class="line">           very_long_second_expression_function() <span class="keyword">as</span> beans, \</span><br><span class="line">           third_thing() <span class="keyword">as</span> eggs:</span><br><span class="line">          place_order(eggs, beans, spam, beans)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">No:  <span class="keyword">with</span> VeryLongFirstExpressionFunction() <span class="keyword">as</span> spam, \</span><br><span class="line">          VeryLongSecondExpressionFunction() <span class="keyword">as</span> beans:</span><br><span class="line">       PlaceOrder(beans, spam)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Yes:  <span class="keyword">with</span> very_long_first_expression_function() <span class="keyword">as</span> spam:</span><br><span class="line">          <span class="keyword">with</span> very_long_second_expression_function() <span class="keyword">as</span> beans:</span><br><span class="line">              place_order(beans, spam)</span><br></pre></td></tr></table></figure>
<p>Make note of the indentation of the elements in the line continuation examples<br>above; see the <a href="#s3.4-indentation">indentation</a> section for explanation.</p>
<p>In all other cases where a line exceeds 80 characters, and the<br><a href="https://github.com/google/yapf/" target="_blank" rel="noopener">yapf</a><br>auto-formatter does not help bring the line below the limit, the line is allowed<br>to exceed this maximum. Authors are encouraged to manually break the line up per<br>the notes above when it is sensible.</p>
<p><a id="s3.3-parentheses"></a><br><a id="33-parentheses"></a></p>
<p><a id="parentheses"></a></p>
<h3 id="3-3-Parentheses"><a href="#3-3-Parentheses" class="headerlink" title="3.3 Parentheses"></a>3.3 Parentheses</h3><p>Use parentheses sparingly.</p>
<p>It is fine, though not required, to use parentheses around tuples. Do not use<br>them in return statements or conditional statements unless using parentheses for<br>implied line continuation or to indicate a tuple.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Yes: <span class="keyword">if</span> foo:</span><br><span class="line">         bar()</span><br><span class="line">     <span class="keyword">while</span> x:</span><br><span class="line">         x = bar()</span><br><span class="line">     <span class="keyword">if</span> x <span class="keyword">and</span> y:</span><br><span class="line">         bar()</span><br><span class="line">     <span class="keyword">if</span> <span class="keyword">not</span> x:</span><br><span class="line">         bar()</span><br><span class="line">     <span class="comment"># For a 1 item tuple the ()s are more visually obvious than the comma.</span></span><br><span class="line">     onesie = (foo,)</span><br><span class="line">     <span class="keyword">return</span> foo</span><br><span class="line">     <span class="keyword">return</span> spam, beans</span><br><span class="line">     <span class="keyword">return</span> (spam, beans)</span><br><span class="line">     <span class="keyword">for</span> (x, y) <span class="keyword">in</span> dict.items(): ...</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">No:  <span class="keyword">if</span> (x):</span><br><span class="line">         bar()</span><br><span class="line">     <span class="keyword">if</span> <span class="keyword">not</span>(x):</span><br><span class="line">         bar()</span><br><span class="line">     <span class="keyword">return</span> (foo)</span><br></pre></td></tr></table></figure>
<p><a id="s3.4-indentation"></a><br><a id="34-indentation"></a></p>
<p><a id="indentation"></a></p>
<h3 id="3-4-Indentation"><a href="#3-4-Indentation" class="headerlink" title="3.4 Indentation"></a>3.4 Indentation</h3><p>Indent your code blocks with <em>4 spaces</em>.</p>
<p>Never use tabs or mix tabs and spaces. In cases of implied line continuation,<br>you should align wrapped elements either vertically, as per the examples in the<br><a href="#s3.2-line-length">line length</a> section; or using a hanging indent of 4 spaces,<br>in which case there should be nothing after the open parenthesis or bracket on<br>the first line.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Yes:   <span class="comment"># Aligned with opening delimiter</span></span><br><span class="line">       foo = long_function_name(var_one, var_two,</span><br><span class="line">                                var_three, var_four)</span><br><span class="line">       meal = (spam,</span><br><span class="line">               beans)</span><br><span class="line"></span><br><span class="line">       <span class="comment"># Aligned with opening delimiter in a dictionary</span></span><br><span class="line">       foo = &#123;</span><br><span class="line">           <span class="string">'long_dictionary_key'</span>: value1 +</span><br><span class="line">                                  value2,</span><br><span class="line">           ...</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment"># 4-space hanging indent; nothing on first line</span></span><br><span class="line">       foo = long_function_name(</span><br><span class="line">           var_one, var_two, var_three,</span><br><span class="line">           var_four)</span><br><span class="line">       meal = (</span><br><span class="line">           spam,</span><br><span class="line">           beans)</span><br><span class="line"></span><br><span class="line">       <span class="comment"># 4-space hanging indent in a dictionary</span></span><br><span class="line">       foo = &#123;</span><br><span class="line">           <span class="string">'long_dictionary_key'</span>:</span><br><span class="line">               long_dictionary_value,</span><br><span class="line">           ...</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">No:    <span class="comment"># Stuff on first line forbidden</span></span><br><span class="line">       foo = long_function_name(var_one, var_two,</span><br><span class="line">           var_three, var_four)</span><br><span class="line">       meal = (spam,</span><br><span class="line">           beans)</span><br><span class="line"></span><br><span class="line">       <span class="comment"># 2-space hanging indent forbidden</span></span><br><span class="line">       foo = long_function_name(</span><br><span class="line">         var_one, var_two, var_three,</span><br><span class="line">         var_four)</span><br><span class="line"></span><br><span class="line">       <span class="comment"># No hanging indent in a dictionary</span></span><br><span class="line">       foo = &#123;</span><br><span class="line">           <span class="string">'long_dictionary_key'</span>:</span><br><span class="line">           long_dictionary_value,</span><br><span class="line">           ...</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>
<p><a id="s3.4.1-trailing-comma"></a><br><a id="s3.4.1-trailing-commas"></a><br><a id="s3.4.1-trailing_comma"></a><br><a id="s3.4.1-trailing_commas"></a><br><a id="341-trailing_comma"></a><br><a id="341-trailing_commas"></a><br><a id="trailing_comma"></a><br><a id="trailing_commas"></a></p>
<p><a id="trailing-comma"></a></p>
<h4 id="3-4-1-Trailing-commas-in-sequences-of-items"><a href="#3-4-1-Trailing-commas-in-sequences-of-items" class="headerlink" title="3.4.1 Trailing commas in sequences of items?"></a>3.4.1 Trailing commas in sequences of items?</h4><p>Trailing commas in sequences of items are recommended only when the closing<br>container token <code>]</code>, <code>)</code>, or <code>}</code> does not appear on the same line as the final<br>element. The presence of a trailing comma is also used as a hint to our Python<br>code auto-formatter <a href="https://pypi.org/project/yapf/" target="_blank" rel="noopener">YAPF</a> to direct it to auto-format the container<br>of items to one item per line when the <code>,</code> after the final element is present.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Yes:   golomb3 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>]</span><br><span class="line">Yes:   golomb4 = [</span><br><span class="line">           <span class="number">0</span>,</span><br><span class="line">           <span class="number">1</span>,</span><br><span class="line">           <span class="number">4</span>,</span><br><span class="line">           <span class="number">6</span>,</span><br><span class="line">       ]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">No:    golomb4 = [</span><br><span class="line">           <span class="number">0</span>,</span><br><span class="line">           <span class="number">1</span>,</span><br><span class="line">           <span class="number">4</span>,</span><br><span class="line">           <span class="number">6</span></span><br><span class="line">       ]</span><br></pre></td></tr></table></figure>
<p><a id="s3.5-blank-lines"></a><br><a id="35-blank-lines"></a></p>
<p><a id="blank-lines"></a></p>
<h3 id="3-5-Blank-Lines"><a href="#3-5-Blank-Lines" class="headerlink" title="3.5 Blank Lines"></a>3.5 Blank Lines</h3><p>Two blank lines between top-level definitions, be they function or class<br>definitions. One blank line between method definitions and between the <code>class</code><br>line and the first method. No blank line following a <code>def</code> line. Use single<br>blank lines as you judge appropriate within functions or methods.</p>
<p><a id="s3.6-whitespace"></a><br><a id="36-whitespace"></a></p>
<p><a id="whitespace"></a></p>
<h3 id="3-6-Whitespace"><a href="#3-6-Whitespace" class="headerlink" title="3.6 Whitespace"></a>3.6 Whitespace</h3><p>Follow standard typographic rules for the use of spaces around punctuation.</p>
<p>No whitespace inside parentheses, brackets or braces.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yes: spam(ham[<span class="number">1</span>], &#123;<span class="string">'eggs'</span>: <span class="number">2</span>&#125;, [])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">No:  spam( ham[ <span class="number">1</span> ], &#123; <span class="string">'eggs'</span>: <span class="number">2</span> &#125;, [ ] )</span><br></pre></td></tr></table></figure>
<p>No whitespace before a comma, semicolon, or colon. Do use whitespace after a<br>comma, semicolon, or colon, except at the end of the line.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Yes: <span class="keyword">if</span> x == <span class="number">4</span>:</span><br><span class="line">         print(x, y)</span><br><span class="line">     x, y = y, x</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">No:  <span class="keyword">if</span> x == <span class="number">4</span> :</span><br><span class="line">         print(x , y)</span><br><span class="line">     x , y = y , x</span><br></pre></td></tr></table></figure>
<p>No whitespace before the open paren/bracket that starts an argument list,<br>indexing or slicing.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yes: spam(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">No:  spam (<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yes: dict[<span class="string">'key'</span>] = list[index]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">No:  dict [<span class="string">'key'</span>] = list [index]</span><br></pre></td></tr></table></figure>
<p>No trailing whitespace.</p>
<p>Surround binary operators with a single space on either side for assignment<br>(<code>=</code>), comparisons (<code>==, &lt;, &gt;, !=, &lt;&gt;, &lt;=, &gt;=, in, not in, is, is not</code>), and<br>Booleans (<code>and, or, not</code>). Use your better judgment for the insertion of spaces<br>around arithmetic operators (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>//</code>, <code>%</code>, <code>**</code>, <code>@</code>).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yes: x == <span class="number">1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">No:  x&lt;<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>Never use spaces around <code>=</code> when passing keyword arguments or defining a default<br>parameter value, with one exception:<br><a href="#typing-default-values">when a type annotation is present</a>, _do_ use spaces<br>around the <code>=</code> for the default parameter value.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Yes: <span class="function"><span class="keyword">def</span> <span class="title">complex</span><span class="params">(real, imag=<span class="number">0.0</span>)</span>:</span> <span class="keyword">return</span> Magic(r=real, i=imag)</span><br><span class="line">Yes: <span class="function"><span class="keyword">def</span> <span class="title">complex</span><span class="params">(real, imag: float = <span class="number">0.0</span>)</span>:</span> <span class="keyword">return</span> Magic(r=real, i=imag)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">No:  <span class="function"><span class="keyword">def</span> <span class="title">complex</span><span class="params">(real, imag = <span class="number">0.0</span>)</span>:</span> <span class="keyword">return</span> Magic(r = real, i = imag)</span><br><span class="line">No:  <span class="function"><span class="keyword">def</span> <span class="title">complex</span><span class="params">(real, imag: float=<span class="number">0.0</span>)</span>:</span> <span class="keyword">return</span> Magic(r = real, i = imag)</span><br></pre></td></tr></table></figure>
<p>Don’t use spaces to vertically align tokens on consecutive lines, since it<br>becomes a maintenance burden (applies to <code>:</code>, <code>#</code>, <code>=</code>, etc.):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line">  foo = <span class="number">1000</span>  <span class="comment"># comment</span></span><br><span class="line">  long_name = <span class="number">2</span>  <span class="comment"># comment that should not be aligned</span></span><br><span class="line"></span><br><span class="line">  dictionary = &#123;</span><br><span class="line">      <span class="string">'foo'</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="string">'long_name'</span>: <span class="number">2</span>,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line">  foo       = <span class="number">1000</span>  <span class="comment"># comment</span></span><br><span class="line">  long_name = <span class="number">2</span>     <span class="comment"># comment that should not be aligned</span></span><br><span class="line"></span><br><span class="line">  dictionary = &#123;</span><br><span class="line">      <span class="string">'foo'</span>      : <span class="number">1</span>,</span><br><span class="line">      <span class="string">'long_name'</span>: <span class="number">2</span>,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p><a id="Python_Interpreter"></a><br><a id="s3.7-shebang-line"></a><br><a id="37-shebang-line"></a></p>
<p><a id="shebang-line"></a></p>
<h3 id="3-7-Shebang-Line"><a href="#3-7-Shebang-Line" class="headerlink" title="3.7 Shebang Line"></a>3.7 Shebang Line</h3><p>Most <code>.py</code> files do not need to start with a <code>#!</code> line. Start the main file of a<br>program with<br><code>#!/usr/bin/env python3</code> (to support virtualenvs) or <code>#!/usr/bin/python3</code> per<br><a href="https://www.python.org/dev/peps/pep-0394/" target="_blank" rel="noopener">PEP-394</a>.</p>
<p>This line is used by the kernel to find the Python interpreter, but is ignored by Python when importing modules. It is only necessary on a file intended to be executed directly.</p>
<p><a id="s3.8-comments-and-docstrings"></a><br><a id="s3.8-comments"></a><br><a id="38-comments-and-docstrings"></a></p>
<p><a id="documentation"></a></p>
<h3 id="3-8-Comments-and-Docstrings"><a href="#3-8-Comments-and-Docstrings" class="headerlink" title="3.8 Comments and Docstrings"></a>3.8 Comments and Docstrings</h3><p>Be sure to use the right style for module, function, method docstrings and<br>inline comments.</p>
<p><a id="s3.8.1-comments-in-doc-strings"></a><br><a id="381-docstrings"></a><br><a id="comments-in-doc-strings"></a></p>
<p><a id="docstrings"></a></p>
<h4 id="3-8-1-Docstrings"><a href="#3-8-1-Docstrings" class="headerlink" title="3.8.1 Docstrings"></a>3.8.1 Docstrings</h4><p>Python uses <em>docstrings</em> to document code. A docstring is a string that is the<br>first statement in a package, module, class or function. These strings can be<br>extracted automatically through the <code>__doc__</code> member of the object and are used<br>by <code>pydoc</code>.<br>(Try running <code>pydoc</code> on your module to see how it looks.) Always use the three<br>double-quote <code>&quot;&quot;&quot;</code> format for docstrings (per<br><a href="https://www.google.com/url?sa=D&amp;q=http://www.python.org/dev/peps/pep-0257/" target="_blank" rel="noopener">PEP 257</a>).<br>A docstring should be organized as a summary line (one physical line not<br>exceeding 80 characters) terminated by a period, question mark, or exclamation<br>point. When writing more (encouraged), this must be followed by a blank line,<br>followed by the rest of the docstring starting at the same cursor position as<br>the first quote of the first line. There are more formatting guidelines for<br>docstrings below.</p>
<p><a id="s3.8.2-comments-in-modules"></a><br><a id="382-modules"></a><br><a id="comments-in-modules"></a></p>
<p><a id="module-docs"></a></p>
<h4 id="3-8-2-Modules"><a href="#3-8-2-Modules" class="headerlink" title="3.8.2 Modules"></a>3.8.2 Modules</h4><p>Every file should contain license boilerplate. Choose the appropriate boilerplate for the license used by the project (for example, Apache 2.0, BSD, LGPL, GPL)</p>
<p>Files should start with a docstring describing the contents and usage of the<br>module.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""A one line summary of the module or program, terminated by a period.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Leave one blank line.  The rest of this docstring should contain an</span></span><br><span class="line"><span class="string">overall description of the module or program.  Optionally, it may also</span></span><br><span class="line"><span class="string">contain a brief description of exported classes and functions and/or usage</span></span><br><span class="line"><span class="string">examples.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Typical usage example:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  foo = ClassFoo()</span></span><br><span class="line"><span class="string">  bar = foo.FunctionBar()</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure></p>
<p><a id="s3.8.3-functions-and-methods"></a><br><a id="383-functions-and-methods"></a><br><a id="functions-and-methods"></a></p>
<p><a id="function-docs"></a></p>
<h4 id="3-8-3-Functions-and-Methods"><a href="#3-8-3-Functions-and-Methods" class="headerlink" title="3.8.3 Functions and Methods"></a>3.8.3 Functions and Methods</h4><p>In this section, “function” means a method, function, or generator.</p>
<p>A function must have a docstring, unless it meets all of the following criteria:</p>
<ul>
<li>not externally visible</li>
<li>very short</li>
<li>obvious</li>
</ul>
<p>A docstring should give enough information to write a call to the function<br>without reading the function’s code. The docstring should describe the<br>function’s calling syntax and its semantics, but generally not its<br>implementation details, unless those details are relevant to how the function is<br>to be used. For example, a function that mutates one of its arguments as a side<br>effect should note that in its docstring. Otherwise, subtle but important<br>details of a function’s implementation that are not relevant to the caller are<br>better expressed as comments alongside the code than within the function’s<br>docstring.</p>
<p>The docstring should be descriptive-style (<code>&quot;&quot;&quot;Fetches rows from a
Bigtable.&quot;&quot;&quot;</code>) rather than imperative-style (<code>&quot;&quot;&quot;Fetch rows from a
Bigtable.&quot;&quot;&quot;</code>). The docstring for a <code>@property</code> data descriptor should use the<br>same style as the docstring for an attribute or a<br><a href="#doc-function-args">function argument</a> (<code>&quot;&quot;&quot;The Bigtable path.&quot;&quot;&quot;</code>,<br>rather than <code>&quot;&quot;&quot;Returns the Bigtable path.&quot;&quot;&quot;</code>).</p>
<p>A method that overrides a method from a base class may have a simple docstring<br>sending the reader to its overridden method’s docstring, such as <code>&quot;&quot;&quot;See base
class.&quot;&quot;&quot;</code>. The rationale is that there is no need to repeat in many places<br>documentation that is already present in the base method’s docstring. However,<br>if the overriding method’s behavior is substantially different from the<br>overridden method, or details need to be provided (e.g., documenting additional<br>side effects), a docstring with at least those differences is required on the<br>overriding method.</p>
<p>Certain aspects of a function should be documented in special sections, listed<br>below. Each section begins with a heading line, which ends with a colon. All<br>sections other than the heading should maintain a hanging indent of two or four<br>spaces (be consistent within a file). These sections can be omitted in cases<br>where the function’s name and signature are informative enough that it can be<br>aptly described using a one-line docstring.</p>
<p><a id="doc-function-args"></a><br><a href="#doc-function-args"><em>Args:</em></a><br>:   List each parameter by name. A description should follow the name, and be<br>    separated by a colon followed by either a space or newline. If the<br>    description is too long to fit on a single 80-character line, use a hanging<br>    indent of 2 or 4 spaces more than the parameter name (be consistent with the<br>    rest of the docstrings in the file). The description should include required<br>    type(s) if the code does not contain a corresponding type annotation. If a<br>    function accepts <code>*foo</code> (variable length argument lists) and/or <code>**bar</code><br>    (arbitrary keyword arguments), they should be listed as <code>*foo</code> and <code>**bar</code>.</p>
<p><a id="doc-function-returns"></a><br><a href="#doc-function-returns"><em>Returns:</em> (or <em>Yields:</em> for generators)</a><br>:   Describe the type and semantics of the return value. If the function only<br>    returns None, this section is not required. It may also be omitted if the<br>    docstring starts with Returns or Yields (e.g. <code>&quot;&quot;&quot;Returns row from Bigtable
    as a tuple of strings.&quot;&quot;&quot;</code>) and the opening sentence is sufficient to<br>    describe return value.</p>
<p><a id="doc-function-raises"></a><br><a href="#doc-function-raises"><em>Raises:</em></a><br>:   List all exceptions that are relevant to the interface followed by a<br>    description. Use a similar exception name + colon + space or newline and<br>    hanging indent style as described in <em>Args:</em>. You should not document<br>    exceptions that get raised if the API specified in the docstring is violated<br>    (because this would paradoxically make behavior under violation of the API<br>    part of the API).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetch_smalltable_rows</span><span class="params">(table_handle: smalltable.Table,</span></span></span><br><span class="line"><span class="function"><span class="params">                          keys: Sequence[Union[bytes, str]],</span></span></span><br><span class="line"><span class="function"><span class="params">                          require_all_keys: bool = False,</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> -&gt; Mapping[bytes, Tuple[str]]:</span></span><br><span class="line">    <span class="string">"""Fetches rows from a Smalltable.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Retrieves rows pertaining to the given keys from the Table instance</span></span><br><span class="line"><span class="string">    represented by table_handle.  String keys will be UTF-8 encoded.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        table_handle: An open smalltable.Table instance.</span></span><br><span class="line"><span class="string">        keys: A sequence of strings representing the key of each table</span></span><br><span class="line"><span class="string">          row to fetch.  String keys will be UTF-8 encoded.</span></span><br><span class="line"><span class="string">        require_all_keys: Optional; If require_all_keys is True only</span></span><br><span class="line"><span class="string">          rows with values set for all keys will be returned.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        A dict mapping keys to the corresponding table row data</span></span><br><span class="line"><span class="string">        fetched. Each row is represented as a tuple of strings. For</span></span><br><span class="line"><span class="string">        example:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &#123;b'Serak': ('Rigel VII', 'Preparer'),</span></span><br><span class="line"><span class="string">         b'Zim': ('Irk', 'Invader'),</span></span><br><span class="line"><span class="string">         b'Lrrr': ('Omicron Persei 8', 'Emperor')&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returned keys are always bytes.  If a key from the keys argument is</span></span><br><span class="line"><span class="string">        missing from the dictionary, then that row was not found in the</span></span><br><span class="line"><span class="string">        table (and require_all_keys must have been False).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Raises:</span></span><br><span class="line"><span class="string">        IOError: An error occurred accessing the smalltable.</span></span><br><span class="line"><span class="string">    """</span></span><br></pre></td></tr></table></figure>
<p>Similarly, this variation on <code>Args:</code> with a line break is also allowed:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetch_smalltable_rows</span><span class="params">(table_handle: smalltable.Table,</span></span></span><br><span class="line"><span class="function"><span class="params">                          keys: Sequence[Union[bytes, str]],</span></span></span><br><span class="line"><span class="function"><span class="params">                          require_all_keys: bool = False,</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> -&gt; Mapping[bytes, Tuple[str]]:</span></span><br><span class="line">    <span class="string">"""Fetches rows from a Smalltable.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Retrieves rows pertaining to the given keys from the Table instance</span></span><br><span class="line"><span class="string">    represented by table_handle.  String keys will be UTF-8 encoded.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">      table_handle:</span></span><br><span class="line"><span class="string">        An open smalltable.Table instance.</span></span><br><span class="line"><span class="string">      keys:</span></span><br><span class="line"><span class="string">        A sequence of strings representing the key of each table row to</span></span><br><span class="line"><span class="string">        fetch.  String keys will be UTF-8 encoded.</span></span><br><span class="line"><span class="string">      require_all_keys:</span></span><br><span class="line"><span class="string">        Optional; If require_all_keys is True only rows with values set</span></span><br><span class="line"><span class="string">        for all keys will be returned.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">      A dict mapping keys to the corresponding table row data</span></span><br><span class="line"><span class="string">      fetched. Each row is represented as a tuple of strings. For</span></span><br><span class="line"><span class="string">      example:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      &#123;b'Serak': ('Rigel VII', 'Preparer'),</span></span><br><span class="line"><span class="string">       b'Zim': ('Irk', 'Invader'),</span></span><br><span class="line"><span class="string">       b'Lrrr': ('Omicron Persei 8', 'Emperor')&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      Returned keys are always bytes.  If a key from the keys argument is</span></span><br><span class="line"><span class="string">      missing from the dictionary, then that row was not found in the</span></span><br><span class="line"><span class="string">      table (and require_all_keys must have been False).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Raises:</span></span><br><span class="line"><span class="string">      IOError: An error occurred accessing the smalltable.</span></span><br><span class="line"><span class="string">    """</span></span><br></pre></td></tr></table></figure>
<p><a id="s3.8.4-comments-in-classes"></a><br><a id="384-classes"></a><br><a id="comments-in-classes"></a></p>
<p><a id="class-docs"></a></p>
<h4 id="3-8-4-Classes"><a href="#3-8-4-Classes" class="headerlink" title="3.8.4 Classes"></a>3.8.4 Classes</h4><p>Classes should have a docstring below the class definition describing the class.<br>If your class has public attributes, they should be documented here in an<br><code>Attributes</code> section and follow the same formatting as a<br><a href="#doc-function-args">function’s <code>Args</code></a> section.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleClass</span>:</span></span><br><span class="line">    <span class="string">"""Summary of class here.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Longer class information....</span></span><br><span class="line"><span class="string">    Longer class information....</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Attributes:</span></span><br><span class="line"><span class="string">        likes_spam: A boolean indicating if we like SPAM or not.</span></span><br><span class="line"><span class="string">        eggs: An integer count of the eggs we have laid.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, likes_spam: bool = False)</span>:</span></span><br><span class="line">        <span class="string">"""Inits SampleClass with blah."""</span></span><br><span class="line">        self.likes_spam = likes_spam</span><br><span class="line">        self.eggs = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">public_method</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Performs operation blah."""</span></span><br></pre></td></tr></table></figure>
<p><a id="s3.8.5-block-and-inline-comments"></a><br><a id="comments-in-block-and-inline"></a><br><a id="s3.8.5-comments-in-block-and-inline"></a><br><a id="385-block-and-inline-comments"></a></p>
<p><a id="comments"></a></p>
<h4 id="3-8-5-Block-and-Inline-Comments"><a href="#3-8-5-Block-and-Inline-Comments" class="headerlink" title="3.8.5 Block and Inline Comments"></a>3.8.5 Block and Inline Comments</h4><p>The final place to have comments is in tricky parts of the code. If you’re going<br>to have to explain it at the next <a href="http://en.wikipedia.org/wiki/Code_review" target="_blank" rel="noopener">code review</a>,<br>you should comment it now. Complicated operations get a few lines of comments<br>before the operations commence. Non-obvious ones get comments at the end of the<br>line.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># We use a weighted dictionary search to find out where i is in</span></span><br><span class="line"><span class="comment"># the array.  We extrapolate position based on the largest num</span></span><br><span class="line"><span class="comment"># in the array and the array size and then do binary search to</span></span><br><span class="line"><span class="comment"># get the exact number.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> i &amp; (i<span class="number">-1</span>) == <span class="number">0</span>:  <span class="comment"># True if i is 0 or a power of 2.</span></span><br></pre></td></tr></table></figure>
<p>To improve legibility, these comments should start at least 2 spaces away from<br>the code with the comment character <code>#</code>, followed by at least one space before<br>the text of the comment itself.</p>
<p>On the other hand, never describe the code. Assume the person reading the code<br>knows Python (though not what you’re trying to do) better than you do.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># BAD COMMENT: Now go through the b array and make sure whenever i occurs</span></span><br><span class="line"><span class="comment"># the next element is i+1</span></span><br></pre></td></tr></table></figure>
<!-- The next section is copied from the C++ style guide. -->
<p><a id="s3.8.6-punctuation-spelling-and-grammar"></a><br><a id="386-punctuation-spelling-and-grammar"></a><br><a id="spelling"></a><br><a id="punctuation"></a><br><a id="grammar"></a></p>
<p><a id="punctuation-spelling-grammar"></a></p>
<h4 id="3-8-6-Punctuation-Spelling-and-Grammar"><a href="#3-8-6-Punctuation-Spelling-and-Grammar" class="headerlink" title="3.8.6 Punctuation, Spelling, and Grammar"></a>3.8.6 Punctuation, Spelling, and Grammar</h4><p>Pay attention to punctuation, spelling, and grammar; it is easier to read<br>well-written comments than badly written ones.</p>
<p>Comments should be as readable as narrative text, with proper capitalization and<br>punctuation. In many cases, complete sentences are more readable than sentence<br>fragments. Shorter comments, such as comments at the end of a line of code, can<br>sometimes be less formal, but you should be consistent with your style.</p>
<p>Although it can be frustrating to have a code reviewer point out that you are<br>using a comma when you should be using a semicolon, it is very important that<br>source code maintain a high level of clarity and readability. Proper<br>punctuation, spelling, and grammar help with that goal.</p>
<p><a id="s3.10-strings"></a><br><a id="310-strings"></a></p>
<p><a id="strings"></a></p>
<h3 id="3-10-Strings"><a href="#3-10-Strings" class="headerlink" title="3.10 Strings"></a>3.10 Strings</h3><p>Use an<br><a href="https://docs.python.org/3/reference/lexical_analysis.html#f-strings" target="_blank" rel="noopener">f-string</a>,<br>the <code>%</code> operator, or the <code>format</code> method for formatting strings, even when the<br>parameters are all strings. Use your best judgment to decide between <code>+</code> and <code>%</code><br>(or <code>format</code>) though. Do not use <code>%</code> or the <code>format</code> method for pure<br>concatenation.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Yes: x = a + b</span><br><span class="line">     x = <span class="string">'%s, %s!'</span> % (imperative, expletive)</span><br><span class="line">     x = <span class="string">'&#123;&#125;, &#123;&#125;'</span>.format(first, second)</span><br><span class="line">     x = <span class="string">'name: %s; score: %d'</span> % (name, n)</span><br><span class="line">     x = <span class="string">'name: &#123;&#125;; score: &#123;&#125;'</span>.format(name, n)</span><br><span class="line">     x = <span class="string">f'name: <span class="subst">&#123;name&#125;</span>; score: <span class="subst">&#123;n&#125;</span>'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">No: x = <span class="string">'%s%s'</span> % (a, b)  <span class="comment"># use + in this case</span></span><br><span class="line">    x = <span class="string">'&#123;&#125;&#123;&#125;'</span>.format(a, b)  <span class="comment"># use + in this case</span></span><br><span class="line">    x = first + <span class="string">', '</span> + second</span><br><span class="line">    x = <span class="string">'name: '</span> + name + <span class="string">'; score: '</span> + str(n)</span><br></pre></td></tr></table></figure>
<p>Avoid using the <code>+</code> and <code>+=</code> operators to accumulate a string within a loop. In<br>some conditions, accumulating a string with addition can lead to quadratic<br>rather than linear running time. Although common accumulations of this sort may<br>be optimized on CPython, that is an implementation detail. The conditions under<br>which an optimization applies are not easy to predict and may change. Instead,<br>add each substring to a list and <code>&#39;&#39;.join</code> the list after the loop terminates,<br>or write each substring to an <code>io.StringIO</code> buffer. These techniques<br>consistently have amortized-linear run time complexity.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Yes: items = [<span class="string">'&lt;table&gt;'</span>]</span><br><span class="line">     <span class="keyword">for</span> last_name, first_name <span class="keyword">in</span> employee_list:</span><br><span class="line">         items.append(<span class="string">'&lt;tr&gt;&lt;td&gt;%s, %s&lt;/td&gt;&lt;/tr&gt;'</span> % (last_name, first_name))</span><br><span class="line">     items.append(<span class="string">'&lt;/table&gt;'</span>)</span><br><span class="line">     employee_table = <span class="string">''</span>.join(items)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">No: employee_table = <span class="string">'&lt;table&gt;'</span></span><br><span class="line">    <span class="keyword">for</span> last_name, first_name <span class="keyword">in</span> employee_list:</span><br><span class="line">        employee_table += <span class="string">'&lt;tr&gt;&lt;td&gt;%s, %s&lt;/td&gt;&lt;/tr&gt;'</span> % (last_name, first_name)</span><br><span class="line">    employee_table += <span class="string">'&lt;/table&gt;'</span></span><br></pre></td></tr></table></figure>
<p>Be consistent with your choice of string quote character within a file. Pick <code>&#39;</code><br>or <code>&quot;</code> and stick with it. It is okay to use the other quote character on a<br>string to avoid the need to <code>\\</code> escape within the string.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line">  Python(<span class="string">'Why are you hiding your eyes?'</span>)</span><br><span class="line">  Gollum(<span class="string">"I'm scared of lint errors."</span>)</span><br><span class="line">  Narrator(<span class="string">'"Good!" thought a happy Python reviewer.'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line">  Python(<span class="string">"Why are you hiding your eyes?"</span>)</span><br><span class="line">  Gollum(<span class="string">'The lint. It burns. It burns us.'</span>)</span><br><span class="line">  Gollum(<span class="string">"Always the great lint. Watching. Watching."</span>)</span><br></pre></td></tr></table></figure>
<p>Prefer <code>&quot;&quot;&quot;</code> for multi-line strings rather than <code>&#39;&#39;&#39;</code>. Projects may choose to<br>use <code>&#39;&#39;&#39;</code> for all non-docstring multi-line strings if and only if they also use<br><code>&#39;</code> for regular strings. Docstrings must use <code>&quot;&quot;&quot;</code> regardless.</p>
<p>Multi-line strings do not flow with the indentation of the rest of the program.<br>If you need to avoid embedding extra space in the string, use either<br>concatenated single-line strings or a multi-line string with<br><a href="https://docs.python.org/3/library/textwrap.html#textwrap.dedent" target="_blank" rel="noopener"><code>textwrap.dedent()</code></a><br>to remove the initial space on each line:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  No:</span><br><span class="line">  long_string = <span class="string">"""This is pretty ugly.</span></span><br><span class="line"><span class="string">Don't do this.</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line">long_string = <span class="string">"""This is fine if your use case can accept</span></span><br><span class="line"><span class="string">    extraneous leading spaces."""</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line">long_string = (<span class="string">"And this is fine if you cannot accept\n"</span> +</span><br><span class="line">               <span class="string">"extraneous leading spaces."</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line">long_string = (<span class="string">"And this too is fine if you cannot accept\n"</span></span><br><span class="line">               <span class="string">"extraneous leading spaces."</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"><span class="keyword">import</span> textwrap</span><br><span class="line"></span><br><span class="line">long_string = textwrap.dedent(<span class="string">"""\</span></span><br><span class="line"><span class="string">    This is also fine, because textwrap.dedent()</span></span><br><span class="line"><span class="string">    will collapse common leading spaces in each line."""</span>)</span><br></pre></td></tr></table></figure>
<p><a id="s3.10.1-logging"></a><br><a id="3101-logging"></a><br><a id="logging"></a></p>
<p><a id="logging"></a></p>
<h4 id="3-10-1-Logging"><a href="#3-10-1-Logging" class="headerlink" title="3.10.1 Logging"></a>3.10.1 Logging</h4><p>For logging functions that expect a pattern-string (with %-placeholders) as<br>their first argument: Always call them with a string literal (not an f-string!)<br>as their first argument with pattern-parameters as subsequent arguments. Some<br>logging implementations collect the unexpanded pattern-string as a queryable<br>field. It also prevents spending time rendering a message that no logger is<br>configured to output.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line">logger = tf.get_logger()</span><br><span class="line">logger.info(<span class="string">'TensorFlow Version is: %s'</span>, tf.__version__)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> absl <span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.info(<span class="string">'Current $PAGER is: %s'</span>, os.getenv(<span class="string">'PAGER'</span>, default=<span class="string">''</span>))</span><br><span class="line"></span><br><span class="line">homedir = os.getenv(<span class="string">'HOME'</span>)</span><br><span class="line"><span class="keyword">if</span> homedir <span class="keyword">is</span> <span class="keyword">None</span> <span class="keyword">or</span> <span class="keyword">not</span> os.access(homedir, os.W_OK):</span><br><span class="line">  logging.error(<span class="string">'Cannot write to home directory, $HOME=%r'</span>, homedir)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> absl <span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.info(<span class="string">'Current $PAGER is:'</span>)</span><br><span class="line">logging.info(os.getenv(<span class="string">'PAGER'</span>, default=<span class="string">''</span>))</span><br><span class="line"></span><br><span class="line">homedir = os.getenv(<span class="string">'HOME'</span>)</span><br><span class="line"><span class="keyword">if</span> homedir <span class="keyword">is</span> <span class="keyword">None</span> <span class="keyword">or</span> <span class="keyword">not</span> os.access(homedir, os.W_OK):</span><br><span class="line">  logging.error(<span class="string">f'Cannot write to home directory, $HOME=<span class="subst">&#123;homedir!r&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>
<p><a id="s3.10.2-error-messages"></a><br><a id="3102-error-messages"></a><br><a id="error-messages"></a></p>
<p><a id="error-messages"></a></p>
<h4 id="3-10-2-Error-Messages"><a href="#3-10-2-Error-Messages" class="headerlink" title="3.10.2 Error Messages"></a>3.10.2 Error Messages</h4><p>Error messages (such as: message strings on exceptions like <code>ValueError</code>, or<br>messages shown to the user) should follow three guidelines:</p>
<ol>
<li><p>The message needs to precisely match the actual error condition.</p>
</li>
<li><p>Interpolated pieces need to always be clearly identifiable as such.</p>
</li>
<li><p>They should allow simple automated processing (e.g. grepping).</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="number">0</span> &lt;= p &lt;= <span class="number">1</span>:</span><br><span class="line">  <span class="keyword">raise</span> ValueError(<span class="string">f'Not a probability: <span class="subst">&#123;p!r&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  os.rmdir(workdir)</span><br><span class="line"><span class="keyword">except</span> OSError <span class="keyword">as</span> error:</span><br><span class="line">  logging.warning(<span class="string">'Could not remove directory (reason: %r): %r'</span>,</span><br><span class="line">                  error, workdir)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line"><span class="keyword">if</span> p &lt; <span class="number">0</span> <span class="keyword">or</span> p &gt; <span class="number">1</span>:  <span class="comment"># PROBLEM: also false for float('nan')!</span></span><br><span class="line">  <span class="keyword">raise</span> ValueError(<span class="string">f'Not a probability: <span class="subst">&#123;p!r&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  os.rmdir(workdir)</span><br><span class="line"><span class="keyword">except</span> OSError:</span><br><span class="line">  <span class="comment"># PROBLEM: Message makes an assumption that might not be true:</span></span><br><span class="line">  <span class="comment"># Deletion might have failed for some other reason, misleading</span></span><br><span class="line">  <span class="comment"># whoever has to debug this.</span></span><br><span class="line">  logging.warning(<span class="string">'Directory already was deleted: %s'</span>, workdir)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  os.rmdir(workdir)</span><br><span class="line"><span class="keyword">except</span> OSError:</span><br><span class="line">  <span class="comment"># PROBLEM: The message is harder to grep for than necessary, and</span></span><br><span class="line">  <span class="comment"># not universally non-confusing for all possible values of `workdir`.</span></span><br><span class="line">  <span class="comment"># Imagine someone calling a library function with such code</span></span><br><span class="line">  <span class="comment"># using a name such as workdir = 'deleted'. The warning would read:</span></span><br><span class="line">  <span class="comment"># "The deleted directory could not be deleted."</span></span><br><span class="line">  logging.warning(<span class="string">'The %s directory could not be deleted.'</span>, workdir)</span><br></pre></td></tr></table></figure>
<p><a id="s3.11-files-sockets-closeables"></a><br><a id="s3.11-files-and-sockets"></a><br><a id="311-files-and-sockets"></a><br><a id="files-and-sockets"></a></p>
<p><a id="files"></a></p>
<h3 id="3-11-Files-Sockets-and-similar-Stateful-Resources"><a href="#3-11-Files-Sockets-and-similar-Stateful-Resources" class="headerlink" title="3.11 Files, Sockets, and similar Stateful Resources"></a>3.11 Files, Sockets, and similar Stateful Resources</h3><p>Explicitly close files and sockets when done with them. This rule naturally<br>extends to closeable resources that internally use sockets, such as database<br>connections, and also other resources that need to be closed down in a similar<br>fashion. To name only a few examples, this also includes<br><a href="https://docs.python.org/3/library/mmap.html" target="_blank" rel="noopener">mmap</a> mappings,<br><a href="https://docs.h5py.org/en/stable/high/file.html" target="_blank" rel="noopener">h5py File objects</a>, and<br><a href="https://matplotlib.org/2.1.0/api/_as_gen/matplotlib.pyplot.close.html" target="_blank" rel="noopener">matplotlib.pyplot figure windows</a>.</p>
<p>Leaving files, sockets or other such stateful objects open unnecessarily has<br>many downsides:</p>
<ul>
<li>They may consume limited system resources, such as file descriptors. Code<br>that deals with many such objects may exhaust those resources unnecessarily<br>if they’re not returned to the system promptly after use.</li>
<li>Holding files open may prevent other actions such as moving or deleting<br>them, or unmounting a filesystem.</li>
<li>Files and sockets that are shared throughout a program may inadvertently be<br>read from or written to after logically being closed. If they are actually<br>closed, attempts to read or write from them will raise exceptions, making<br>the problem known sooner.</li>
</ul>
<p>Furthermore, while files and sockets (and some similarly behaving resources) are<br>automatically closed when the object is destructed, coupling the lifetime of the<br>object to the state of the resource is poor practice:</p>
<ul>
<li>There are no guarantees as to when the runtime will actually invoke the<br><code>__del__</code> method. Different Python implementations use different memory<br>management techniques, such as delayed garbage collection, which may<br>increase the object’s lifetime arbitrarily and indefinitely.</li>
<li>Unexpected references to the file, e.g. in globals or exception tracebacks,<br>may keep it around longer than intended.</li>
</ul>
<p>Relying on finalizers to do automatic cleanup that has observable side effects<br>has been rediscovered over and over again to lead to major problems, across many<br>decades and multiple languages (see e.g.<br><a href="https://wiki.sei.cmu.edu/confluence/display/java/MET12-J.+Do+not+use+finalizers" target="_blank" rel="noopener">this article</a><br>for Java).</p>
<p>The preferred way to manage files and similar resources is using the<br><a href="http://docs.python.org/reference/compound_stmts.html#the-with-statement" target="_blank" rel="noopener"><code>with</code> statement</a>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">"hello.txt"</span>) <span class="keyword">as</span> hello_file:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> hello_file:</span><br><span class="line">        print(line)</span><br></pre></td></tr></table></figure>
<p>For file-like objects that do not support the <code>with</code> statement, use<br><code>contextlib.closing()</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> contextlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> contextlib.closing(urllib.urlopen(<span class="string">"http://www.python.org/"</span>)) <span class="keyword">as</span> front_page:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> front_page:</span><br><span class="line">        print(line)</span><br></pre></td></tr></table></figure>
<p>In rare cases where context-based resource management is infeasible, code<br>documentation must explain clearly how resource lifetime is managed.</p>
<p><a id="s3.12-todo-comments"></a><br><a id="312-todo-comments"></a></p>
<p><a id="todo"></a></p>
<h3 id="3-12-TODO-Comments"><a href="#3-12-TODO-Comments" class="headerlink" title="3.12 TODO Comments"></a>3.12 TODO Comments</h3><p>Use <code>TODO</code> comments for code that is temporary, a short-term solution, or<br>good-enough but not perfect.</p>
<p>A <code>TODO</code> comment begins with the string <code>TODO</code> in all caps and a parenthesized<br>name, e-mail address, or other identifier<br>of the person or issue with the best context about the problem. This is followed<br>by an explanation of what there is to do.</p>
<p>The purpose is to have a consistent <code>TODO</code> format that can be searched to find<br>out how to get more details. A <code>TODO</code> is not a commitment that the person<br>referenced will fix the problem. Thus when you create a<br><code>TODO</code>, it is almost always your name<br>that is given.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># TODO(kl@gmail.com): Use a "*" here for string repetition.</span></span><br><span class="line"><span class="comment"># TODO(Zeke) Change this to use relations.</span></span><br></pre></td></tr></table></figure>
<p>If your <code>TODO</code> is of the form “At a future date do something” make sure that you<br>either include a very specific date (“Fix by November 2009”) or a very specific<br>event (“Remove this code when all clients can handle XML responses.”).</p>
<p><a id="s3.13-imports-formatting"></a><br><a id="313-imports-formatting"></a></p>
<p><a id="imports-formatting"></a></p>
<h3 id="3-13-Imports-formatting"><a href="#3-13-Imports-formatting" class="headerlink" title="3.13 Imports formatting"></a>3.13 Imports formatting</h3><p>Imports should be on separate lines; there are<br><a href="#typing-imports">exceptions for <code>typing</code> imports</a>.</p>
<p>E.g.:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Yes: <span class="keyword">import</span> os</span><br><span class="line">     <span class="keyword">import</span> sys</span><br><span class="line">     <span class="keyword">from</span> typing <span class="keyword">import</span> Mapping, Sequence</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">No:  <span class="keyword">import</span> os, sys</span><br></pre></td></tr></table></figure>
<p>Imports are always put at the top of the file, just after any module comments<br>and docstrings and before module globals and constants. Imports should be<br>grouped from most generic to least generic:</p>
<ol>
<li><p>Python future import statements. For example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> absolute_import</span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br></pre></td></tr></table></figure>
<p>See <a href="#from-future-imports">above</a> for more information about those.</p>
</li>
<li><p>Python standard library imports. For example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://pypi.org/" target="_blank" rel="noopener">third-party</a> module<br>or package imports. For example:</p>
</li>
</ol>
<pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br></pre></td></tr></table></figure>
</code></pre><ol start="4">
<li>Code repository<br>sub-package imports. For example:</li>
</ol>
<pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> otherproject.ai <span class="keyword">import</span> mind</span><br></pre></td></tr></table></figure>
</code></pre><ol start="5">
<li><strong>Deprecated:</strong> application-specific imports that are part of the same<br>top level<br>sub-package as this file. For example:</li>
</ol>
<pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> myproject.backend.hgwells <span class="keyword">import</span> time_machine</span><br></pre></td></tr></table></figure>

You may find older Google Python Style code doing this, but it is no longer
required. **New code is encouraged not to bother with this.** Simply treat
application-specific sub-package imports the same as other sub-package
imports.
</code></pre><p>Within each grouping, imports should be sorted lexicographically, ignoring case,<br>according to each module’s full package path (the <code>path</code> in <code>from path import
...</code>). Code may optionally place a blank line between import sections.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> absl <span class="keyword">import</span> app</span><br><span class="line"><span class="keyword">from</span> absl <span class="keyword">import</span> flags</span><br><span class="line"><span class="keyword">import</span> bs4</span><br><span class="line"><span class="keyword">import</span> cryptography</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> book.genres <span class="keyword">import</span> scifi</span><br><span class="line"><span class="keyword">from</span> myproject.backend <span class="keyword">import</span> huxley</span><br><span class="line"><span class="keyword">from</span> myproject.backend.hgwells <span class="keyword">import</span> time_machine</span><br><span class="line"><span class="keyword">from</span> myproject.backend.state_machine <span class="keyword">import</span> main_loop</span><br><span class="line"><span class="keyword">from</span> otherproject.ai <span class="keyword">import</span> body</span><br><span class="line"><span class="keyword">from</span> otherproject.ai <span class="keyword">import</span> mind</span><br><span class="line"><span class="keyword">from</span> otherproject.ai <span class="keyword">import</span> soul</span><br><span class="line"></span><br><span class="line"><span class="comment"># Older style code may have these imports down here instead:</span></span><br><span class="line"><span class="comment">#from myproject.backend.hgwells import time_machine</span></span><br><span class="line"><span class="comment">#from myproject.backend.state_machine import main_loop</span></span><br></pre></td></tr></table></figure>
<p><a id="s3.14-statements"></a><br><a id="314-statements"></a></p>
<p><a id="statements"></a></p>
<h3 id="3-14-Statements"><a href="#3-14-Statements" class="headerlink" title="3.14 Statements"></a>3.14 Statements</h3><p>Generally only one statement per line.</p>
<p>However, you may put the result of a test on the same line as the test only if<br>the entire statement fits on one line. In particular, you can never do so with<br><code>try</code>/<code>except</code> since the <code>try</code> and <code>except</code> can’t both fit on the same line, and<br>you can only do so with an <code>if</code> if there is no <code>else</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> foo: bar(foo)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> foo: bar(foo)</span><br><span class="line">  <span class="keyword">else</span>:   baz(foo)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span>:               bar(foo)</span><br><span class="line">  <span class="keyword">except</span> ValueError: baz(foo)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">      bar(foo)</span><br><span class="line">  <span class="keyword">except</span> ValueError: baz(foo)</span><br></pre></td></tr></table></figure>
<p><a id="s3.15-accessors"></a><br><a id="s3.15-access-control"></a><br><a id="315-access-control"></a><br><a id="access-control"></a></p>
<p><a id="accessors"></a></p>
<h3 id="3-15-Accessors"><a href="#3-15-Accessors" class="headerlink" title="3.15 Accessors"></a>3.15 Accessors</h3><p>If an accessor function would be trivial, you should use public variables<br>instead of accessor functions to avoid the extra cost of function calls in<br>Python. When more functionality is added you can use <code>property</code> to keep the<br>syntax consistent.</p>
<p>On the other hand, if access is more complex, or the cost of accessing the<br>variable is significant, you should use function calls (following the<br><a href="#s3.16-naming">Naming</a> guidelines) such as <code>get_foo()</code> and <code>set_foo()</code>. If the<br>past behavior allowed access through a property, do not bind the new accessor<br>functions to the property. Any code still attempting to access the variable by<br>the old method should break visibly so they are made aware of the change in<br>complexity.</p>
<p><a id="s3.16-naming"></a><br><a id="316-naming"></a></p>
<p><a id="naming"></a></p>
<h3 id="3-16-Naming"><a href="#3-16-Naming" class="headerlink" title="3.16 Naming"></a>3.16 Naming</h3><p><code>module_name</code>, <code>package_name</code>, <code>ClassName</code>, <code>method_name</code>, <code>ExceptionName</code>,<br><code>function_name</code>, <code>GLOBAL_CONSTANT_NAME</code>, <code>global_var_name</code>, <code>instance_var_name</code>,<br><code>function_parameter_name</code>, <code>local_var_name</code>.</p>
<p>Function names, variable names, and filenames should be descriptive; eschew<br>abbreviation. In particular, do not use abbreviations that are ambiguous or<br>unfamiliar to readers outside your project, and do not abbreviate by deleting<br>letters within a word.</p>
<p>Always use a <code>.py</code> filename extension. Never use dashes.</p>
<p><a id="s3.16.1-names-to-avoid"></a><br><a id="3161-names-to-avoid"></a></p>
<p><a id="names-to-avoid"></a></p>
<h4 id="3-16-1-Names-to-Avoid"><a href="#3-16-1-Names-to-Avoid" class="headerlink" title="3.16.1 Names to Avoid"></a>3.16.1 Names to Avoid</h4><ul>
<li><p>single character names, except for specifically allowed cases:</p>
<ul>
<li>counters or iterators (e.g. <code>i</code>, <code>j</code>, <code>k</code>, <code>v</code>, et al.)</li>
<li><code>e</code> as an exception identifier in <code>try/except</code> statements.</li>
<li><code>f</code> as a file handle in <code>with</code> statements</li>
</ul>
<p>Please be mindful not to abuse single-character naming. Generally speaking,<br>descriptiveness should be proportional to the name’s scope of visibility.<br>For example, <code>i</code> might be a fine name for 5-line code block but within<br>multiple nested scopes, it is likely too vague.</p>
</li>
<li><p>dashes (<code>-</code>) in any package/module name</p>
</li>
<li><p><code>__double_leading_and_trailing_underscore__</code> names (reserved by Python)</p>
</li>
<li><p>offensive terms</p>
</li>
<li><p>names that needlessly include the type of the variable (for example:<br><code>id_to_name_dict</code>)</p>
</li>
</ul>
<p><a id="s3.16.2-naming-conventions"></a><br><a id="3162-naming-convention"></a></p>
<p><a id="naming-conventions"></a></p>
<h4 id="3-16-2-Naming-Conventions"><a href="#3-16-2-Naming-Conventions" class="headerlink" title="3.16.2 Naming Conventions"></a>3.16.2 Naming Conventions</h4><ul>
<li><p>“Internal” means internal to a module, or protected or private within a<br>class.</p>
</li>
<li><p>Prepending a single underscore (<code>_</code>) has some support for protecting module<br>variables and functions (linters will flag protected member access).</p>
</li>
<li><p>Prepending a double underscore (<code>__</code> aka “dunder”) to an instance variable<br>or method effectively makes the variable or method private to its class<br>(using name mangling); we discourage its use as it impacts readability and<br>testability, and isn’t <em>really</em> private. Prefer a single underscore.</p>
</li>
<li><p>Place related classes and top-level functions together in a<br>module.<br>Unlike Java, there is no need to limit yourself to one class per module.</p>
</li>
<li><p>Use CapWords for class names, but lower_with_under.py for module names.<br>Although there are some old modules named CapWords.py, this is now<br>discouraged because it’s confusing when the module happens to be named after<br>a class. (“wait – did I write <code>import StringIO</code> or <code>from StringIO import
StringIO</code>?”)</p>
</li>
<li><p>Underscores may appear in <em>unittest</em> method names starting with <code>test</code> to<br>separate logical components of the name, even if those components use<br>CapWords. One possible pattern is <code>test&lt;MethodUnderTest&gt;_&lt;state&gt;</code>; for<br>example <code>testPop_EmptyStack</code> is okay. There is no One Correct Way to name<br>test methods.</p>
</li>
</ul>
<p><a id="s3.16.3-file-naming"></a><br><a id="3163-file-naming"></a></p>
<p><a id="file-naming"></a></p>
<h4 id="3-16-3-File-Naming"><a href="#3-16-3-File-Naming" class="headerlink" title="3.16.3 File Naming"></a>3.16.3 File Naming</h4><p>Python filenames must have a <code>.py</code> extension and must not contain dashes (<code>-</code>).<br>This allows them to be imported and unittested. If you want an executable to be<br>accessible without the extension, use a symbolic link or a simple bash wrapper<br>containing <code>exec &quot;$0.py&quot; &quot;$@&quot;</code>.</p>
<p><a id="s3.16.4-guidelines-derived-from-guidos-recommendations"></a><br><a id="3164-guidelines-derived-from-guidos-recommendations"></a></p>
<p><a id="guidelines-derived-from-guidos-recommendations"></a></p>
<h4 id="3-16-4-Guidelines-derived-from-Guido‘s-Recommendations"><a href="#3-16-4-Guidelines-derived-from-Guido‘s-Recommendations" class="headerlink" title="3.16.4 Guidelines derived from Guido‘s Recommendations"></a>3.16.4 Guidelines derived from <a href="https://en.wikipedia.org/wiki/Guido_van_Rossum" target="_blank" rel="noopener">Guido</a>‘s Recommendations</h4><table rules="all" border="1" summary="Guidelines from Guido's Recommendations" cellspacing="2" cellpadding="2"><br><br>  <tr><br>    <th>Type</th><br>    <th>Public</th><br>    <th>Internal</th><br>  </tr><br><br>  <tr><br>    <td>Packages</td><br>    <td><code>lower_with_under</code></td><br>    <td></td><br>  </tr><br><br>  <tr><br>    <td>Modules</td><br>    <td><code>lower_with_under</code></td><br>    <td><code>_lower_with_under</code></td><br>  </tr><br><br>  <tr><br>    <td>Classes</td><br>    <td><code>CapWords</code></td><br>    <td><code>_CapWords</code></td><br>  </tr><br><br>  <tr><br>    <td>Exceptions</td><br>    <td><code>CapWords</code></td><br>    <td></td><br>  </tr><br><br>  <tr><br>    <td>Functions</td><br>    <td><code>lower_with_under()</code></td><br>    <td><code>_lower_with_under()</code></td><br>  </tr><br><br>  <tr><br>    <td>Global/Class Constants</td><br>    <td><code>CAPS_WITH_UNDER</code></td><br>    <td><code>_CAPS_WITH_UNDER</code></td><br>  </tr><br><br>  <tr><br>    <td>Global/Class Variables</td><br>    <td><code>lower_with_under</code></td><br>    <td><code>_lower_with_under</code></td><br>  </tr><br><br>  <tr><br>    <td>Instance Variables</td><br>    <td><code>lower_with_under</code></td><br>    <td><code>_lower_with_under</code> (protected)</td><br>  </tr><br><br>  <tr><br>    <td>Method Names</td><br>    <td><code>lower_with_under()</code></td><br>    <td><code>_lower_with_under()</code> (protected)</td><br>  </tr><br><br>  <tr><br>    <td>Function/Method Parameters</td><br>    <td><code>lower_with_under</code></td><br>    <td></td><br>  </tr><br><br>  <tr><br>    <td>Local Variables</td><br>    <td><code>lower_with_under</code></td><br>    <td></td><br>  </tr><br><br></table>


<p><a id="s3.17-main"></a><br><a id="317-main"></a></p>
<p><a id="math-notation"></a></p>
<h4 id="3-16-5-Mathematical-Notation"><a href="#3-16-5-Mathematical-Notation" class="headerlink" title="3.16.5 Mathematical Notation"></a>3.16.5 Mathematical Notation</h4><p>For mathematically heavy code, short variable names that would otherwise violate<br>the style guide are preferred when they match established notation in a<br>reference paper or algorithm. When doing so, reference the source of all naming<br>conventions in a comment or docstring or, if the source is not accessible,<br>clearly document the naming conventions. Prefer PEP8-compliant<br><code>descriptive_names</code> for public APIs, which are much more likely to be<br>encountered out of context.</p>
<p><a id="main"></a></p>
<h3 id="3-17-Main"><a href="#3-17-Main" class="headerlink" title="3.17 Main"></a>3.17 Main</h3><p>In Python, <code>pydoc</code> as well as unit tests require modules to be importable. If a<br>file is meant to be used as an executable, its main functionality should be in a<br><code>main()</code> function, and your code should always check <code>if __name__ == &#39;__main__&#39;</code><br>before executing your main program, so that it is not executed when the module<br>is imported.</p>
<p>When using <a href="https://github.com/abseil/abseil-py" target="_blank" rel="noopener">absl</a>, use <code>app.run</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> absl <span class="keyword">import</span> app</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(argv: Sequence[str])</span>:</span></span><br><span class="line">    <span class="comment"># process non-flag arguments</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(main)</span><br></pre></td></tr></table></figure>
<p>Otherwise, use:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>All code at the top level will be executed when the module is imported. Be<br>careful not to call functions, create objects, or perform other operations that<br>should not be executed when the file is being <code>pydoc</code>ed.</p>
<p><a id="s3.18-function-length"></a><br><a id="318-function-length"></a></p>
<p><a id="function-length"></a></p>
<h3 id="3-18-Function-length"><a href="#3-18-Function-length" class="headerlink" title="3.18 Function length"></a>3.18 Function length</h3><p>Prefer small and focused functions.</p>
<p>We recognize that long functions are sometimes appropriate, so no hard limit is<br>placed on function length. If a function exceeds about 40 lines, think about<br>whether it can be broken up without harming the structure of the program.</p>
<p>Even if your long function works perfectly now, someone modifying it in a few<br>months may add new behavior. This could result in bugs that are hard to find.<br>Keeping your functions short and simple makes it easier for other people to read<br>and modify your code.</p>
<p>You could find long and complicated functions when working with<br>some<br>code. Do not be intimidated by modifying existing code: if working with such a<br>function proves to be difficult, you find that errors are hard to debug, or you<br>want to use a piece of it in several different contexts, consider breaking up<br>the function into smaller and more manageable pieces.</p>
<p><a id="s3.19-type-annotations"></a><br><a id="319-type-annotations"></a></p>
<p><a id="type-annotations"></a></p>
<h3 id="3-19-Type-Annotations"><a href="#3-19-Type-Annotations" class="headerlink" title="3.19 Type Annotations"></a>3.19 Type Annotations</h3><p><a id="s3.19.1-general-rules"></a><br><a id="s3.19.1-general"></a><br><a id="3191-general-rules"></a></p>
<p><a id="typing-general"></a></p>
<h4 id="3-19-1-General-Rules"><a href="#3-19-1-General-Rules" class="headerlink" title="3.19.1 General Rules"></a>3.19.1 General Rules</h4><ul>
<li>Familiarize yourself with<br><a href="https://www.python.org/dev/peps/pep-0484/" target="_blank" rel="noopener">PEP-484</a>.</li>
<li>In methods, only annotate <code>self</code>, or <code>cls</code> if it is necessary for proper<br>type information. e.g., <code>@classmethod def create(cls: Type[T]) -&gt; T: return
cls()</code></li>
<li>If any other variable or a returned type should not be expressed, use <code>Any</code>.</li>
<li>You are not required to annotate all the functions in a module.<ul>
<li>At least annotate your public APIs.</li>
<li>Use judgment to get to a good balance between safety and clarity on the<br>one hand, and flexibility on the other.</li>
<li>Annotate code that is prone to type-related errors (previous bugs or<br>complexity).</li>
<li>Annotate code that is hard to understand.</li>
<li>Annotate code as it becomes stable from a types perspective. In many<br>cases, you can annotate all the functions in mature code without losing<br>too much flexibility.</li>
</ul>
</li>
</ul>
<p><a id="s3.19.2-line-breaking"></a><br><a id="3192-line-breaking"></a></p>
<p><a id="typing-line-breaking"></a></p>
<h4 id="3-19-2-Line-Breaking"><a href="#3-19-2-Line-Breaking" class="headerlink" title="3.19.2 Line Breaking"></a>3.19.2 Line Breaking</h4><p>Try to follow the existing <a href="#indentation">indentation</a> rules.</p>
<p>After annotating, many function signatures will become “one parameter per line”.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span><span class="params">(self,</span></span></span><br><span class="line"><span class="function"><span class="params">              first_var: int,</span></span></span><br><span class="line"><span class="function"><span class="params">              second_var: Foo,</span></span></span><br><span class="line"><span class="function"><span class="params">              third_var: Optional[Bar])</span> -&gt; int:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>Always prefer breaking between variables, and not, for example, between variable<br>names and type annotations. However, if everything fits on the same line, go for<br>it.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span><span class="params">(self, first_var: int)</span> -&gt; int:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>If the combination of the function name, the last parameter, and the return type<br>is too long, indent by 4 in a new line.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    self, first_var: int)</span> -&gt; Tuple[MyLongType1, MyLongType1]:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>When the return type does not fit on the same line as the last parameter, the<br>preferred way is to indent the parameters by 4 on a new line and align the<br>closing parenthesis with the <code>def</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    self, other_arg: Optional[MyLongType]</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> -&gt; Dict[OtherLongType, MyLongType]:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p><code>pylint</code><br>allows you to move the closing parenthesis to a new line and align with the<br>opening one, but this is less readable.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span><span class="params">(self,</span></span></span><br><span class="line"><span class="function"><span class="params">              other_arg: Optional[MyLongType]</span></span></span><br><span class="line"><span class="function"><span class="params">             )</span> -&gt; Dict[OtherLongType, MyLongType]:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>As in the examples above, prefer not to break types. However, sometimes they are<br>too long to be on a single line (try to keep sub-types unbroken).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    self,</span></span></span><br><span class="line"><span class="function"><span class="params">    first_var: Tuple[List[MyLongType1],</span></span></span><br><span class="line"><span class="function"><span class="params">                     List[MyLongType2]],</span></span></span><br><span class="line"><span class="function"><span class="params">    second_var: List[Dict[</span></span></span><br><span class="line"><span class="function"><span class="params">        MyLongType3, MyLongType4]])</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>If a single name and type is too long, consider using an<br><a href="#typing-aliases">alias</a> for the type. The last resort is to break after the<br>colon and indent by 4.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_function</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    long_variable_name:</span></span></span><br><span class="line"><span class="function"><span class="params">        long_module_name.LongTypeName,</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_function</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    long_variable_name: long_module_name.</span></span></span><br><span class="line"><span class="function"><span class="params">        LongTypeName,</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p><a id="s3.19.3-forward-declarations"></a><br><a id="3193-forward-declarations"></a></p>
<p><a id="forward-declarations"></a></p>
<h4 id="3-19-3-Forward-Declarations"><a href="#3-19-3-Forward-Declarations" class="headerlink" title="3.19.3 Forward Declarations"></a>3.19.3 Forward Declarations</h4><p>If you need to use a class name from the same module that is not yet defined –<br>for example, if you need the class inside the class declaration, or if you use a<br>class that is defined below – use a string for the class name.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>:</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,</span></span></span><br><span class="line"><span class="function"><span class="params">               stack: List[<span class="string">"MyClass"</span>])</span> -&gt; <span class="keyword">None</span>:</span></span><br></pre></td></tr></table></figure>
<p><a id="s3.19.4-default-values"></a><br><a id="3194-default-values"></a></p>
<p><a id="typing-default-values"></a></p>
<h4 id="3-19-4-Default-Values"><a href="#3-19-4-Default-Values" class="headerlink" title="3.19.4 Default Values"></a>3.19.4 Default Values</h4><p>As per<br><a href="https://www.python.org/dev/peps/pep-0008/#other-recommendations" target="_blank" rel="noopener">PEP-008</a>, use<br>spaces around the <code>=</code> <em>only</em> for arguments that have both a type annotation and<br>a default value.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(a: int = <span class="number">0</span>)</span> -&gt; int:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(a:int=<span class="number">0</span>)</span> -&gt; int:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p><a id="s3.19.5-nonetype"></a><br><a id="s3.19.5-none-type"></a><br><a id="3195-nonetype"></a></p>
<p><a id="none-type"></a></p>
<h4 id="3-19-5-NoneType"><a href="#3-19-5-NoneType" class="headerlink" title="3.19.5 NoneType"></a>3.19.5 NoneType</h4><p>In the Python type system, <code>NoneType</code> is a “first class” type, and for typing<br>purposes, <code>None</code> is an alias for <code>NoneType</code>. If an argument can be <code>None</code>, it<br>has to be declared! You can use <code>Union</code>, but if there is only one other type,<br>use <code>Optional</code>.</p>
<p>Use explicit <code>Optional</code> instead of implicit <code>Optional</code>. Earlier versions of PEP<br>484 allowed <code>a: str = None</code> to be interpreted as <code>a: Optional[str] = None</code>, but<br>that is no longer the preferred behavior.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(a: Optional[str], b: Optional[str] = None)</span> -&gt; str:</span></span><br><span class="line">  ...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multiple_nullable_union</span><span class="params">(a: Union[None, str, int])</span> -&gt; str:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">No:</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nullable_union</span><span class="params">(a: Union[None, str])</span> -&gt; str:</span></span><br><span class="line">  ...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">implicit_optional</span><span class="params">(a: str = None)</span> -&gt; str:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p><a id="s3.19.6-type-aliases"></a><br><a id="s3.19.6-aliases"></a><br><a id="3196-type-aliases"></a><br><a id="typing-aliases"></a></p>
<p><a id="type-aliases"></a></p>
<h4 id="3-19-6-Type-Aliases"><a href="#3-19-6-Type-Aliases" class="headerlink" title="3.19.6 Type Aliases"></a>3.19.6 Type Aliases</h4><p>You can declare aliases of complex types. The name of an alias should be<br>CapWorded. If the alias is used only in this module, it should be _Private.</p>
<p>For example, if the name of the module together with the name of the type is too<br>long:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_ShortName = module_with_long_name.TypeWithLongName</span><br><span class="line">ComplexMap = Mapping[str, List[Tuple[int, int]]]</span><br></pre></td></tr></table></figure>
<p>Other examples are complex nested types and multiple return variables from a<br>function (as a tuple).</p>
<p><a id="s3.19.7-ignoring-types"></a><br><a id="s3.19.7-ignore"></a><br><a id="3197-ignoring-types"></a></p>
<p><a id="typing-ignore"></a></p>
<h4 id="3-19-7-Ignoring-Types"><a href="#3-19-7-Ignoring-Types" class="headerlink" title="3.19.7 Ignoring Types"></a>3.19.7 Ignoring Types</h4><p>You can disable type checking on a line with the special comment <code># type:
ignore</code>.</p>
<p><code>pytype</code> has a disable option for specific errors (similar to lint):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pytype: disable=attribute-error</span></span><br></pre></td></tr></table></figure>
<p><a id="s3.19.8-typing-variables"></a><br><a id="s3.19.8-comments"></a><br><a id="3198-typing-internal-variables"></a></p>
<p><a id="typing-variables"></a></p>
<h4 id="3-19-8-Typing-Variables"><a href="#3-19-8-Typing-Variables" class="headerlink" title="3.19.8 Typing Variables"></a>3.19.8 Typing Variables</h4><p>If an internal variable has a type that is hard or impossible to infer, you can<br>specify its type in a couple ways.</p>
<p><a id="type-comments"></a><br><a href="#type-comments"><em>Type Comments:</em></a><br>:   Use a <code># type:</code> comment on the end of the line</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = SomeUndecoratedFunction()  <span class="comment"># type: Foo</span></span><br></pre></td></tr></table></figure>
<p><a id="annotated-assignments"></a><br><a href="#annotated-assignments"><em>Annotated Assignments</em></a><br>:   Use a colon and type between the variable name and value, as with function<br>    arguments.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a: Foo = SomeUndecoratedFunction()</span><br></pre></td></tr></table></figure>
<p><a id="s3.19.9-tuples-vs-lists"></a><br><a id="s3.19.9-tuples"></a><br><a id="3199-tuples-vs-lists"></a></p>
<p><a id="typing-tuples"></a></p>
<h4 id="3-19-9-Tuples-vs-Lists"><a href="#3-19-9-Tuples-vs-Lists" class="headerlink" title="3.19.9 Tuples vs Lists"></a>3.19.9 Tuples vs Lists</h4><p>Typed lists can only contain objects of a single type. Typed tuples can either<br>have a single repeated type or a set number of elements with different types.<br>The latter is commonly used as the return type from a function.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]  <span class="comment"># type: List[int]</span></span><br><span class="line">b = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)  <span class="comment"># type: Tuple[int, ...]</span></span><br><span class="line">c = (<span class="number">1</span>, <span class="string">"2"</span>, <span class="number">3.5</span>)  <span class="comment"># type: Tuple[int, str, float]</span></span><br></pre></td></tr></table></figure>
<p><a id="s3.19.10-typevars"></a><br><a id="s3.19.10-type-var"></a><br><a id="31910-typevar"></a><br><a id="typing-type-var"></a></p>
<p><a id="typevars"></a></p>
<h4 id="3-19-10-TypeVars"><a href="#3-19-10-TypeVars" class="headerlink" title="3.19.10 TypeVars"></a>3.19.10 TypeVars</h4><p>The Python type system has<br><a href="https://www.python.org/dev/peps/pep-0484/#generics" target="_blank" rel="noopener">generics</a>. The factory<br>function <code>TypeVar</code> is a common way to use them.</p>
<p>Example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List, TypeVar</span><br><span class="line">T = TypeVar(<span class="string">"T"</span>)</span><br><span class="line">...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(l: List[T])</span> -&gt; T:</span></span><br><span class="line">  <span class="keyword">return</span> l.pop()</span><br></pre></td></tr></table></figure>
<p>A TypeVar can be constrained:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AddableType = TypeVar(<span class="string">"AddableType"</span>, int, float, str)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(a: AddableType, b: AddableType)</span> -&gt; AddableType:</span></span><br><span class="line">  <span class="keyword">return</span> a + b</span><br></pre></td></tr></table></figure>
<p>A common predefined type variable in the <code>typing</code> module is <code>AnyStr</code>. Use it for<br>multiple annotations that can be <code>bytes</code> or <code>unicode</code> and must all be the same<br>type.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> AnyStr</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_length</span><span class="params">(x: AnyStr)</span> -&gt; AnyStr:</span></span><br><span class="line">  <span class="keyword">if</span> len(x) &lt;= <span class="number">42</span>:</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">  <span class="keyword">raise</span> ValueError()</span><br></pre></td></tr></table></figure>
<p><a id="s3.19.11-string-types"></a><br><a id="s3.19.11-strings"></a><br><a id="31911-string-types"></a></p>
<p><a id="typing-strings"></a></p>
<h4 id="3-19-11-String-types"><a href="#3-19-11-String-types" class="headerlink" title="3.19.11 String types"></a>3.19.11 String types</h4><p>The proper type for annotating strings depends on what versions of Python the<br>code is intended for.</p>
<p>Prefer to use <code>str</code>, though <code>Text</code> is also acceptable. Be consistent in using<br>one or the other. For code that deals with binary data, use <code>bytes</code>. For Python<br>2 compatible code that processes text data (<code>str</code> or <code>unicode</code> in Python 2,<br><code>str</code> in Python 3), use <code>Text</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deals_with_text_data_in_py3</span><span class="params">(x: str)</span> -&gt; str:</span></span><br><span class="line">  ...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deals_with_binary_data</span><span class="params">(x: bytes)</span> -&gt; bytes:</span></span><br><span class="line">  ...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">py2_compatible_text_data_processor</span><span class="params">(x: Text)</span> -&gt; Text:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>In some uncommon Python 2 compatibility cases, <code>str</code> may make sense instead of<br><code>Text</code>, typically to aid compatibility when the return types aren’t the same<br>between Python 2 and Python 3. Never use <code>unicode</code> as it doesn’t exist in Python</p>
<ol start="3">
<li>The reason this discrepancy exists is because <code>str</code> means something different<br>in Python 2 than in Python 3.</li>
</ol>
<p>No:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">py2_code</span><span class="params">(x: str)</span> -&gt; unicode:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>If the type can be either bytes or text, use <code>Union</code>, with the appropriate text<br>type.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Text, Union</span><br><span class="line">...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">py3_only</span><span class="params">(x: Union[bytes, str])</span> -&gt; Union[bytes, str]:</span></span><br><span class="line">  ...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">py2_compatible</span><span class="params">(x: Union[bytes, Text])</span> -&gt; Union[bytes, Text]:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>If all the string types of a function are always the same, for example if the<br>return type is the same as the argument type in the code above, use<br><a href="#typing-type-var">AnyStr</a>.</p>
<p><a id="s3.19.12-imports-for-typing"></a><br><a id="s3.19.12-imports"></a><br><a id="31912-imports-for-typing"></a></p>
<p><a id="typing-imports"></a></p>
<h4 id="3-19-12-Imports-For-Typing"><a href="#3-19-12-Imports-For-Typing" class="headerlink" title="3.19.12 Imports For Typing"></a>3.19.12 Imports For Typing</h4><p>For classes from the <code>typing</code> module, always import the class itself. You are<br>explicitly allowed to import multiple specific classes on one line from the<br><code>typing</code> module. Ex:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Any, Dict, Optional</span><br></pre></td></tr></table></figure>
<p>Given that this way of importing from <code>typing</code> adds items to the local<br>namespace, any names in <code>typing</code> should be treated similarly to keywords, and<br>not be defined in your Python code, typed or not. If there is a collision<br>between a type and an existing name in a module, import it using <code>import x as
y</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Any <span class="keyword">as</span> AnyType</span><br></pre></td></tr></table></figure>
<p><a id="s3.19.13-conditional-imports"></a><br><a id="31913-conditional-imports"></a></p>
<p><a id="typing-conditional-imports"></a></p>
<h4 id="3-19-13-Conditional-Imports"><a href="#3-19-13-Conditional-Imports" class="headerlink" title="3.19.13 Conditional Imports"></a>3.19.13 Conditional Imports</h4><p>Use conditional imports only in exceptional cases where the additional imports<br>needed for type checking must be avoided at runtime. This pattern is<br>discouraged; alternatives such as refactoring the code to allow top level<br>imports should be preferred.</p>
<p>Imports that are needed only for type annotations can be placed within an <code>if
TYPE_CHECKING:</code> block.</p>
<ul>
<li>Conditionally imported types need to be referenced as strings, to be forward<br>compatible with Python 3.6 where the annotation expressions are actually<br>evaluated.</li>
<li>Only entities that are used solely for typing should be defined here; this<br>includes aliases. Otherwise it will be a runtime error, as the module will<br>not be imported at runtime.</li>
<li>The block should be right after all the normal imports.</li>
<li>There should be no empty lines in the typing imports list.</li>
<li>Sort this list as if it were a regular imports list.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> typing</span><br><span class="line"><span class="keyword">if</span> typing.TYPE_CHECKING:</span><br><span class="line">  <span class="keyword">import</span> sketch</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x: <span class="string">"sketch.Sketch"</span>)</span>:</span> ...</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><a id="s3.19.14-circular-dependencies"></a><br><a id="s3.19.14-circular-deps"></a><br><a id="31914-circular-dependencies"></a></p>
<p><a id="typing-circular-deps"></a></p>
<h4 id="3-19-14-Circular-Dependencies"><a href="#3-19-14-Circular-Dependencies" class="headerlink" title="3.19.14 Circular Dependencies"></a>3.19.14 Circular Dependencies</h4><p>Circular dependencies that are caused by typing are code smells. Such code is a<br>good candidate for refactoring. Although technically it is possible to keep<br>circular dependencies, various build systems will not let you do so<br>because each module has to depend on the other.</p>
<p>Replace modules that create circular dependency imports with <code>Any</code>. Set an<br><a href="#typing-aliases">alias</a> with a meaningful name, and use the real type name from<br>this module (any attribute of Any is Any). Alias definitions should be separated<br>from the last import by one line.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Any</span><br><span class="line"></span><br><span class="line">some_mod = Any  <span class="comment"># some_mod.py imports this module.</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_method</span><span class="params">(self, var: <span class="string">"some_mod.SomeType"</span>)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p><a id="typing-generics"></a><br><a id="s3.19.15-generics"></a><br><a id="31915-generics"></a></p>
<p><a id="generics"></a></p>
<h4 id="3-19-15-Generics"><a href="#3-19-15-Generics" class="headerlink" title="3.19.15 Generics"></a>3.19.15 Generics</h4><p>When annotating, prefer to specify type parameters for generic types; otherwise,<br><a href="https://www.python.org/dev/peps/pep-0484/#the-any-type" target="_blank" rel="noopener">the generics’ parameters will be assumed to be <code>Any</code></a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_names</span><span class="params">(employee_ids: List[int])</span> -&gt; Dict[int, Any]:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># These are both interpreted as get_names(employee_ids: List[Any]) -&gt; Dict[Any, Any]</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_names</span><span class="params">(employee_ids: list)</span> -&gt; Dict:</span></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_names</span><span class="params">(employee_ids: List)</span> -&gt; Dict:</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>If the best type parameter for a generic is <code>Any</code>, make it explicit, but<br>remember that in many cases <a href="#typing-type-var"><code>TypeVar</code></a> might be more<br>appropriate:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_names</span><span class="params">(employee_ids: List[Any])</span> -&gt; Dict[Any, str]:</span></span><br><span class="line">  <span class="string">"""Returns a mapping from employee ID to employee name for given IDs."""</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">T = TypeVar(<span class="string">'T'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_names</span><span class="params">(employee_ids: List[T])</span> -&gt; Dict[T, str]:</span></span><br><span class="line">  <span class="string">"""Returns a mapping from employee ID to employee name for given IDs."""</span></span><br></pre></td></tr></table></figure>
<p><a id="4-parting-words"></a></p>
<p><a id="consistency"></a></p>
<h2 id="4-Parting-Words"><a href="#4-Parting-Words" class="headerlink" title="4 Parting Words"></a>4 Parting Words</h2><p><em>BE CONSISTENT</em>.</p>
<p>If you’re editing code, take a few minutes to look at the code around you and<br>determine its style. If they use spaces around all their arithmetic operators,<br>you should too. If their comments have little boxes of hash marks around them,<br>make your comments have little boxes of hash marks around them too.</p>
<p>The point of having style guidelines is to have a common vocabulary of coding so<br>people can concentrate on what you’re saying rather than on how you’re saying<br>it. We present global style rules here so people know the vocabulary, but local<br>style is also important. If code you add to a file looks drastically different<br>from the existing code around it, it throws readers out of their rhythm when<br>they go to read it. Avoid this.</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Python/" rel="tag"># Python</a>
          
            <a href="/tags/Google/" rel="tag"># Google</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/uploads/avatar.png" alt="Chenyi Liao">
            
              <p class="site-author-name" itemprop="name">Chenyi Liao</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">100</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">53</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">104</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/liaocyintl" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://theme-next.iissnan.com/" title="Hexo Next Theme" target="_blank">Hexo Next Theme</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#谷歌Python代码规范"><span class="nav-number">1.</span> <span class="nav-text">谷歌Python代码规范</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-背景"><span class="nav-number">1.1.</span> <span class="nav-text">1 背景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Python语言规则"><span class="nav-number">1.2.</span> <span class="nav-text">2 Python语言规则</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Lint"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1 Lint</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-定义"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">2.1.1 定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-优点"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">2.1.2 优点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-缺点"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">2.1.3 缺点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-4-结论"><span class="nav-number">1.2.1.4.</span> <span class="nav-text">2.1.4 结论</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-导入-Import"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.2 导入 Import</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-1-定义"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">2.2.1 定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-2-优点"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">2.2.2 优点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-3-缺点"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">2.2.3 缺点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-4-结论"><span class="nav-number">1.2.2.4.</span> <span class="nav-text">2.2.4 结论</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-包-Packages"><span class="nav-number">1.2.3.</span> <span class="nav-text">2.3 包 Packages</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-Pros"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">2.3.1 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-Cons"><span class="nav-number">1.2.3.2.</span> <span class="nav-text">2.3.2 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3-Decision"><span class="nav-number">1.2.3.3.</span> <span class="nav-text">2.3.3 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-Exceptions"><span class="nav-number">1.2.4.</span> <span class="nav-text">2.4 Exceptions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-1-Definition"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">2.4.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-2-Pros"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">2.4.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-3-Cons"><span class="nav-number">1.2.4.3.</span> <span class="nav-text">2.4.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-4-Decision"><span class="nav-number">1.2.4.4.</span> <span class="nav-text">2.4.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-Global-variables"><span class="nav-number">1.2.5.</span> <span class="nav-text">2.5 Global variables</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-1-Definition"><span class="nav-number">1.2.5.1.</span> <span class="nav-text">2.5.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-2-Pros"><span class="nav-number">1.2.5.2.</span> <span class="nav-text">2.5.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-3-Cons"><span class="nav-number">1.2.5.3.</span> <span class="nav-text">2.5.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-4-Decision"><span class="nav-number">1.2.5.4.</span> <span class="nav-text">2.5.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-Nested-Local-Inner-Classes-and-Functions"><span class="nav-number">1.2.6.</span> <span class="nav-text">2.6 Nested/Local/Inner Classes and Functions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-1-Definition"><span class="nav-number">1.2.6.1.</span> <span class="nav-text">2.6.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-2-Pros"><span class="nav-number">1.2.6.2.</span> <span class="nav-text">2.6.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-3-Cons"><span class="nav-number">1.2.6.3.</span> <span class="nav-text">2.6.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-4-Decision"><span class="nav-number">1.2.6.4.</span> <span class="nav-text">2.6.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-Comprehensions-amp-Generator-Expressions"><span class="nav-number">1.2.7.</span> <span class="nav-text">2.7 Comprehensions &amp; Generator Expressions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-1-Definition"><span class="nav-number">1.2.7.1.</span> <span class="nav-text">2.7.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-2-Pros"><span class="nav-number">1.2.7.2.</span> <span class="nav-text">2.7.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-3-Cons"><span class="nav-number">1.2.7.3.</span> <span class="nav-text">2.7.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-4-Decision"><span class="nav-number">1.2.7.4.</span> <span class="nav-text">2.7.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-8-Default-Iterators-and-Operators"><span class="nav-number">1.2.8.</span> <span class="nav-text">2.8 Default Iterators and Operators</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-8-1-Definition"><span class="nav-number">1.2.8.1.</span> <span class="nav-text">2.8.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-8-2-Pros"><span class="nav-number">1.2.8.2.</span> <span class="nav-text">2.8.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-8-3-Cons"><span class="nav-number">1.2.8.3.</span> <span class="nav-text">2.8.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-8-4-Decision"><span class="nav-number">1.2.8.4.</span> <span class="nav-text">2.8.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-Generators"><span class="nav-number">1.2.9.</span> <span class="nav-text">2.9 Generators</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-9-Definition"><span class="nav-number">1.2.9.1.</span> <span class="nav-text">2.9 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-9-2-Pros"><span class="nav-number">1.2.9.2.</span> <span class="nav-text">2.9.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-9-3-Cons"><span class="nav-number">1.2.9.3.</span> <span class="nav-text">2.9.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-9-4-Decision"><span class="nav-number">1.2.9.4.</span> <span class="nav-text">2.9.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-10-Lambda-Functions"><span class="nav-number">1.2.10.</span> <span class="nav-text">2.10 Lambda Functions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-10-1-Definition"><span class="nav-number">1.2.10.1.</span> <span class="nav-text">2.10.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-10-2-Pros"><span class="nav-number">1.2.10.2.</span> <span class="nav-text">2.10.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-10-3-Cons"><span class="nav-number">1.2.10.3.</span> <span class="nav-text">2.10.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-10-4-Decision"><span class="nav-number">1.2.10.4.</span> <span class="nav-text">2.10.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-11-Conditional-Expressions"><span class="nav-number">1.2.11.</span> <span class="nav-text">2.11 Conditional Expressions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-11-1-Definition"><span class="nav-number">1.2.11.1.</span> <span class="nav-text">2.11.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-11-2-Pros"><span class="nav-number">1.2.11.2.</span> <span class="nav-text">2.11.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-11-3-Cons"><span class="nav-number">1.2.11.3.</span> <span class="nav-text">2.11.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-11-4-Decision"><span class="nav-number">1.2.11.4.</span> <span class="nav-text">2.11.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-12-Default-Argument-Values"><span class="nav-number">1.2.12.</span> <span class="nav-text">2.12 Default Argument Values</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-12-1-Definition"><span class="nav-number">1.2.12.1.</span> <span class="nav-text">2.12.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-12-2-Pros"><span class="nav-number">1.2.12.2.</span> <span class="nav-text">2.12.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-12-3-Cons"><span class="nav-number">1.2.12.3.</span> <span class="nav-text">2.12.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-12-4-Decision"><span class="nav-number">1.2.12.4.</span> <span class="nav-text">2.12.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-13-Properties"><span class="nav-number">1.2.13.</span> <span class="nav-text">2.13 Properties</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-13-1-Definition"><span class="nav-number">1.2.13.1.</span> <span class="nav-text">2.13.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-13-2-Pros"><span class="nav-number">1.2.13.2.</span> <span class="nav-text">2.13.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-13-3-Cons"><span class="nav-number">1.2.13.3.</span> <span class="nav-text">2.13.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-13-4-Decision"><span class="nav-number">1.2.13.4.</span> <span class="nav-text">2.13.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-14-True-False-Evaluations"><span class="nav-number">1.2.14.</span> <span class="nav-text">2.14 True/False Evaluations</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-14-1-Definition"><span class="nav-number">1.2.14.1.</span> <span class="nav-text">2.14.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-14-2-Pros"><span class="nav-number">1.2.14.2.</span> <span class="nav-text">2.14.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-14-3-Cons"><span class="nav-number">1.2.14.3.</span> <span class="nav-text">2.14.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-14-4-Decision"><span class="nav-number">1.2.14.4.</span> <span class="nav-text">2.14.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-16-Lexical-Scoping"><span class="nav-number">1.2.15.</span> <span class="nav-text">2.16 Lexical Scoping</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-16-1-Definition"><span class="nav-number">1.2.15.1.</span> <span class="nav-text">2.16.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-16-2-Pros"><span class="nav-number">1.2.15.2.</span> <span class="nav-text">2.16.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-16-3-Cons"><span class="nav-number">1.2.15.3.</span> <span class="nav-text">2.16.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-16-4-Decision"><span class="nav-number">1.2.15.4.</span> <span class="nav-text">2.16.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-17-Function-and-Method-Decorators"><span class="nav-number">1.2.16.</span> <span class="nav-text">2.17 Function and Method Decorators</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-17-1-Definition"><span class="nav-number">1.2.16.1.</span> <span class="nav-text">2.17.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-17-2-Pros"><span class="nav-number">1.2.16.2.</span> <span class="nav-text">2.17.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-17-3-Cons"><span class="nav-number">1.2.16.3.</span> <span class="nav-text">2.17.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-17-4-Decision"><span class="nav-number">1.2.16.4.</span> <span class="nav-text">2.17.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-18-Threading"><span class="nav-number">1.2.17.</span> <span class="nav-text">2.18 Threading</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-19-Power-Features"><span class="nav-number">1.2.18.</span> <span class="nav-text">2.19 Power Features</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-19-1-Definition"><span class="nav-number">1.2.18.1.</span> <span class="nav-text">2.19.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-19-2-Pros"><span class="nav-number">1.2.18.2.</span> <span class="nav-text">2.19.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-19-3-Cons"><span class="nav-number">1.2.18.3.</span> <span class="nav-text">2.19.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-19-4-Decision"><span class="nav-number">1.2.18.4.</span> <span class="nav-text">2.19.4 Decision</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-20-Modern-Python-from-future-imports"><span class="nav-number">1.2.19.</span> <span class="nav-text">2.20 Modern Python: from __future__ imports</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-20-1-Definition"><span class="nav-number">1.2.19.1.</span> <span class="nav-text">2.20.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-20-2-Pros"><span class="nav-number">1.2.19.2.</span> <span class="nav-text">2.20.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-20-3-Cons"><span class="nav-number">1.2.19.3.</span> <span class="nav-text">2.20.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-20-4-Decision"><span class="nav-number">1.2.19.4.</span> <span class="nav-text">2.20.4 Decision</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#from-future-imports"><span class="nav-number">1.2.19.4.1.</span> <span class="nav-text">from __future__ imports</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#The-six-future-and-past-libraries"><span class="nav-number">1.2.19.4.2.</span> <span class="nav-text">The six, future, and past libraries</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-21-Type-Annotated-Code"><span class="nav-number">1.2.20.</span> <span class="nav-text">2.21 Type Annotated Code</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-21-1-Definition"><span class="nav-number">1.2.20.1.</span> <span class="nav-text">2.21.1 Definition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-21-2-Pros"><span class="nav-number">1.2.20.2.</span> <span class="nav-text">2.21.2 Pros</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-21-3-Cons"><span class="nav-number">1.2.20.3.</span> <span class="nav-text">2.21.3 Cons</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-21-4-Decision"><span class="nav-number">1.2.20.4.</span> <span class="nav-text">2.21.4 Decision</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Python-Style-Rules"><span class="nav-number">1.3.</span> <span class="nav-text">3 Python Style Rules</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-Semicolons"><span class="nav-number">1.3.1.</span> <span class="nav-text">3.1 Semicolons</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-Line-length"><span class="nav-number">1.3.2.</span> <span class="nav-text">3.2 Line length</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-Parentheses"><span class="nav-number">1.3.3.</span> <span class="nav-text">3.3 Parentheses</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-Indentation"><span class="nav-number">1.3.4.</span> <span class="nav-text">3.4 Indentation</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-1-Trailing-commas-in-sequences-of-items"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">3.4.1 Trailing commas in sequences of items?</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-Blank-Lines"><span class="nav-number">1.3.5.</span> <span class="nav-text">3.5 Blank Lines</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-Whitespace"><span class="nav-number">1.3.6.</span> <span class="nav-text">3.6 Whitespace</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-Shebang-Line"><span class="nav-number">1.3.7.</span> <span class="nav-text">3.7 Shebang Line</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-8-Comments-and-Docstrings"><span class="nav-number">1.3.8.</span> <span class="nav-text">3.8 Comments and Docstrings</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-8-1-Docstrings"><span class="nav-number">1.3.8.1.</span> <span class="nav-text">3.8.1 Docstrings</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-8-2-Modules"><span class="nav-number">1.3.8.2.</span> <span class="nav-text">3.8.2 Modules</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-8-3-Functions-and-Methods"><span class="nav-number">1.3.8.3.</span> <span class="nav-text">3.8.3 Functions and Methods</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-8-4-Classes"><span class="nav-number">1.3.8.4.</span> <span class="nav-text">3.8.4 Classes</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-8-5-Block-and-Inline-Comments"><span class="nav-number">1.3.8.5.</span> <span class="nav-text">3.8.5 Block and Inline Comments</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-8-6-Punctuation-Spelling-and-Grammar"><span class="nav-number">1.3.8.6.</span> <span class="nav-text">3.8.6 Punctuation, Spelling, and Grammar</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-10-Strings"><span class="nav-number">1.3.9.</span> <span class="nav-text">3.10 Strings</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-10-1-Logging"><span class="nav-number">1.3.9.1.</span> <span class="nav-text">3.10.1 Logging</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-10-2-Error-Messages"><span class="nav-number">1.3.9.2.</span> <span class="nav-text">3.10.2 Error Messages</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-11-Files-Sockets-and-similar-Stateful-Resources"><span class="nav-number">1.3.10.</span> <span class="nav-text">3.11 Files, Sockets, and similar Stateful Resources</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-12-TODO-Comments"><span class="nav-number">1.3.11.</span> <span class="nav-text">3.12 TODO Comments</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-13-Imports-formatting"><span class="nav-number">1.3.12.</span> <span class="nav-text">3.13 Imports formatting</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-14-Statements"><span class="nav-number">1.3.13.</span> <span class="nav-text">3.14 Statements</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-15-Accessors"><span class="nav-number">1.3.14.</span> <span class="nav-text">3.15 Accessors</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-16-Naming"><span class="nav-number">1.3.15.</span> <span class="nav-text">3.16 Naming</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-16-1-Names-to-Avoid"><span class="nav-number">1.3.15.1.</span> <span class="nav-text">3.16.1 Names to Avoid</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-16-2-Naming-Conventions"><span class="nav-number">1.3.15.2.</span> <span class="nav-text">3.16.2 Naming Conventions</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-16-3-File-Naming"><span class="nav-number">1.3.15.3.</span> <span class="nav-text">3.16.3 File Naming</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-16-4-Guidelines-derived-from-Guido‘s-Recommendations"><span class="nav-number">1.3.15.4.</span> <span class="nav-text">3.16.4 Guidelines derived from Guido‘s Recommendations</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-16-5-Mathematical-Notation"><span class="nav-number">1.3.15.5.</span> <span class="nav-text">3.16.5 Mathematical Notation</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-17-Main"><span class="nav-number">1.3.16.</span> <span class="nav-text">3.17 Main</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-18-Function-length"><span class="nav-number">1.3.17.</span> <span class="nav-text">3.18 Function length</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-19-Type-Annotations"><span class="nav-number">1.3.18.</span> <span class="nav-text">3.19 Type Annotations</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-1-General-Rules"><span class="nav-number">1.3.18.1.</span> <span class="nav-text">3.19.1 General Rules</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-2-Line-Breaking"><span class="nav-number">1.3.18.2.</span> <span class="nav-text">3.19.2 Line Breaking</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-3-Forward-Declarations"><span class="nav-number">1.3.18.3.</span> <span class="nav-text">3.19.3 Forward Declarations</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-4-Default-Values"><span class="nav-number">1.3.18.4.</span> <span class="nav-text">3.19.4 Default Values</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-5-NoneType"><span class="nav-number">1.3.18.5.</span> <span class="nav-text">3.19.5 NoneType</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-6-Type-Aliases"><span class="nav-number">1.3.18.6.</span> <span class="nav-text">3.19.6 Type Aliases</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-7-Ignoring-Types"><span class="nav-number">1.3.18.7.</span> <span class="nav-text">3.19.7 Ignoring Types</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-8-Typing-Variables"><span class="nav-number">1.3.18.8.</span> <span class="nav-text">3.19.8 Typing Variables</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-9-Tuples-vs-Lists"><span class="nav-number">1.3.18.9.</span> <span class="nav-text">3.19.9 Tuples vs Lists</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-10-TypeVars"><span class="nav-number">1.3.18.10.</span> <span class="nav-text">3.19.10 TypeVars</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-11-String-types"><span class="nav-number">1.3.18.11.</span> <span class="nav-text">3.19.11 String types</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-12-Imports-For-Typing"><span class="nav-number">1.3.18.12.</span> <span class="nav-text">3.19.12 Imports For Typing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-13-Conditional-Imports"><span class="nav-number">1.3.18.13.</span> <span class="nav-text">3.19.13 Conditional Imports</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-14-Circular-Dependencies"><span class="nav-number">1.3.18.14.</span> <span class="nav-text">3.19.14 Circular Dependencies</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-19-15-Generics"><span class="nav-number">1.3.18.15.</span> <span class="nav-text">3.19.15 Generics</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Parting-Words"><span class="nav-number">1.4.</span> <span class="nav-text">4 Parting Words</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chenyi Liao</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>



  <div class="footer-custom"><p>Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a> and <a href="https://github.com/" style="font-weight: bold">Github</a></p></div>



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://liaocy-net.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://liaocy.net/2021/08/04-pyguide/';
          this.page.identifier = '2021/08/04-pyguide/';
          this.page.title = '【译】谷歌Python代码规范（翻译中）';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://liaocy-net.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
    
  </script>

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
